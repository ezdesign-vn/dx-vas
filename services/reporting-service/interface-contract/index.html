
<!doctype html>
<html lang="vi" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Tài liệu kiến trúc và phát triển cho dự án Chuyển đổi số Trường Việt Anh.">
      
      
        <meta name="author" content="DX VAS Team">
      
      
        <link rel="canonical" href="https://ezdesign-vn.github.io/dx-vas/services/reporting-service/interface-contract/">
      
      
      
      
      <link rel="icon" href="../../../assets/images/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Reporting Service – Interface Contract - DX VAS - Docs</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="pink">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#reporting-service-interface-contract" class="md-skip">
          Bỏ qua
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Đầu trang">
    <a href="../../.." title="DX VAS - Docs" class="md-header__button md-logo" aria-label="DX VAS - Docs" data-md-component="logo">
      
  <img src="../../../assets/images/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            DX VAS - Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Reporting Service – Interface Contract
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="pink"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="lime"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Tìm kiếm" placeholder="Tìm kiếm" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Tìm kiếm">
        
        <button type="reset" class="md-search__icon md-icon" title="Xoá" aria-label="Xoá" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/ezdesign-vn/dx-vas.git" title="Xem mã nguồn" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    ezdesign.vn/dx-vas
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../architecture/system-diagrams/" class="md-tabs__link">
          
  
  
    
  
  Kiến trúc Hệ thống

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../dev-guide/" class="md-tabs__link">
        
  
  
    
  
  Hướng dẫn Phát triển

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../" class="md-tabs__link">
        
  
  
    
  
  Thiết kế Services

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../ADR/" class="md-tabs__link">
          
  
  
    
  
  Quyết định Kiến trúc (ADRs)

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Thanh điều hướng" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="DX VAS - Docs" class="md-nav__button md-logo" aria-label="DX VAS - Docs" data-md-component="logo">
      
  <img src="../../../assets/images/logo.png" alt="logo">

    </a>
    DX VAS - Docs
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ezdesign-vn/dx-vas.git" title="Xem mã nguồn" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    ezdesign.vn/dx-vas
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Kiến trúc Hệ thống
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Kiến trúc Hệ thống
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../architecture/system-diagrams/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sơ đồ Hệ thống
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../architecture/rbac-deep-dive/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RBAC Chi tiết
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../dev-guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Hướng dẫn Phát triển
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Thiết kế Services
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../ADR/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Quyết định Kiến trúc (ADRs)
    
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Quyết định Kiến trúc (ADRs)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Mục lục">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Mục lục
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#2-tom-tat-endpoint-http-method" class="md-nav__link">
    <span class="md-ellipsis">
      2. 📌 Tóm tắt Endpoint &amp; HTTP Method
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-nhom-api-reports-truy-van-bao-cao" class="md-nav__link">
    <span class="md-ellipsis">
      2. Nhóm API: /reports – Truy vấn báo cáo
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Nhóm API: /reports – Truy vấn báo cáo">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#post-reportsquery" class="md-nav__link">
    <span class="md-ellipsis">
      POST /reports/query
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-nhom-api-report-templates-quan-ly-mau-bao-cao" class="md-nav__link">
    <span class="md-ellipsis">
      3. Nhóm API: /report-templates – Quản lý mẫu báo cáo
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Nhóm API: /report-templates – Quản lý mẫu báo cáo">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get-report-templates" class="md-nav__link">
    <span class="md-ellipsis">
      GET /report-templates
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-report-templatesid" class="md-nav__link">
    <span class="md-ellipsis">
      GET /report-templates/{id}
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#post-report-templates" class="md-nav__link">
    <span class="md-ellipsis">
      POST /report-templates
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#patch-report-templatesid" class="md-nav__link">
    <span class="md-ellipsis">
      PATCH /report-templates/{id}
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete-report-templatesid" class="md-nav__link">
    <span class="md-ellipsis">
      DELETE /report-templates/{id}
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-nhom-api-saved-configs-quan-ly-cau-hinh-bao-cao-ca-nhan-tuy-chon" class="md-nav__link">
    <span class="md-ellipsis">
      4. Nhóm API: /saved-configs – Quản lý cấu hình báo cáo cá nhân (Tùy chọn)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Nhóm API: /saved-configs – Quản lý cấu hình báo cáo cá nhân (Tùy chọn)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get-saved-configs" class="md-nav__link">
    <span class="md-ellipsis">
      GET /saved-configs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#post-saved-configs" class="md-nav__link">
    <span class="md-ellipsis">
      POST /saved-configs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete-saved-configsid" class="md-nav__link">
    <span class="md-ellipsis">
      DELETE /saved-configs/{id}
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#phu-luc" class="md-nav__link">
    <span class="md-ellipsis">
      📎 Phụ lục
    </span>
  </a>
  
    <nav class="md-nav" aria-label="📎 Phụ lục">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chuan-hoa-ma-loi-error-codes" class="md-nav__link">
    <span class="md-ellipsis">
      📚 Chuẩn hóa mã lỗi (Error Codes)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tai-lieu-lien-quan" class="md-nav__link">
    <span class="md-ellipsis">
      📚 Tài liệu liên quan
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="reporting-service-interface-contract">📘 Reporting Service – Interface Contract<a class="headerlink" href="#reporting-service-interface-contract" title="Permanent link">¶</a></h1>
<ul>
<li>Tài liệu này mô tả các API chính mà <strong>Reporting Service</strong> cung cấp, phục vụ nhu cầu báo cáo phân tích toàn hệ thống.</li>
<li><em>Phạm vi (Scope):</em>
  Reporting Service cho phép Superadmin Webapp và các AI Agent truy vấn các báo cáo đã được định nghĩa qua Report Template, quản lý Template và các cấu hình báo cáo đã lưu. Service không trực tiếp xử lý pipeline ETL hay ghi dữ liệu vào Data Warehouse, mà chỉ tương tác dạng read/query.</li>
</ul>
<blockquote>
<p>🧭 <strong>Nguyên tắc chung (General Principles):</strong>
- Tất cả API yêu cầu <code>Authorization: Bearer &lt;JWT&gt;</code>.
- Header <code>X-Tenant-ID</code> được yêu cầu cho mọi request.
- Header <code>X-Request-ID</code> được sinh ra và trả về trong response để hỗ trợ trace.
- Các response theo chuẩn <a href="../../../ADR/adr-012-response-structure/">ADR-012 Response Structure</a>.
- Các lỗi theo chuẩn <a href="../../../ADR/adr-011-api-error-format/">ADR-011 Error Format</a>.
- Tất cả response dạng <code>GET</code> là dạng <code>cached</code>, nếu có <code>ETag</code> được trả về thì nên dùng <code>If-None-Match</code> để giảm tải.</p>
</blockquote>
<hr />
<h2 id="2-tom-tat-endpoint-http-method">2. 📌 Tóm tắt Endpoint &amp; HTTP Method<a class="headerlink" href="#2-tom-tat-endpoint-http-method" title="Permanent link">¶</a></h2>
<table>
<thead>
<tr>
<th>Method</th>
<th>Endpoint</th>
<th>Mô tả ngắn</th>
<th>Phân hệ</th>
<th>Yêu cầu quyền</th>
</tr>
</thead>
<tbody>
<tr>
<td>POST</td>
<td><code>/reports/query</code></td>
<td>Truy vấn báo cáo theo template</td>
<td>Query Engine</td>
<td><code>report.view_*</code></td>
</tr>
<tr>
<td>GET</td>
<td><code>/report-templates</code></td>
<td>Lấy danh sách template</td>
<td>Template Management</td>
<td><code>report.view_templates</code></td>
</tr>
<tr>
<td>GET</td>
<td><code>/report-templates/{id}</code></td>
<td>Chi tiết template</td>
<td>Template Management</td>
<td><code>report.view_templates</code></td>
</tr>
<tr>
<td>POST</td>
<td><code>/report-templates</code></td>
<td>Tạo template mới</td>
<td>Template Management</td>
<td><code>report.manage_templates</code></td>
</tr>
<tr>
<td>PATCH</td>
<td><code>/report-templates/{id}</code></td>
<td>Cập nhật template</td>
<td>Template Management</td>
<td><code>report.manage_templates</code></td>
</tr>
<tr>
<td>DELETE</td>
<td><code>/report-templates/{id}</code></td>
<td>Vô hiệu hóa template</td>
<td>Template Management</td>
<td><code>report.manage_templates</code></td>
</tr>
<tr>
<td>GET</td>
<td><code>/saved-configs</code></td>
<td>Danh sách cấu hình cá nhân</td>
<td>Saved Config</td>
<td><code>report.view_saved_config</code></td>
</tr>
<tr>
<td>POST</td>
<td><code>/saved-configs</code></td>
<td>Lưu cấu hình báo cáo</td>
<td>Saved Config</td>
<td><code>report.manage_saved_config</code></td>
</tr>
<tr>
<td>DELETE</td>
<td><code>/saved-configs/{id}</code></td>
<td>Xóa cấu hình đã lưu</td>
<td>Saved Config</td>
<td><code>report.manage_saved_config</code></td>
</tr>
</tbody>
</table>
<hr />
<blockquote>
<p>📘 <strong>HTTP Status Codes dùng chung:</strong></p>
<ul>
<li><code>200 OK</code>: Thành công</li>
<li><code>201 Created</code>: Tạo mới thành công</li>
<li><code>204 No Content</code>: Xóa thành công</li>
<li><code>400 Bad Request</code>: Input không hợp lệ</li>
<li><code>401 Unauthorized</code>: JWT token không hợp lệ</li>
<li><code>403 Forbidden</code>: Thiếu permission theo RBAC</li>
<li><code>404 Not Found</code>: Không tìm thấy tài nguyên</li>
<li><code>409 Conflict</code>: Phiên bản xung đột</li>
<li><code>422 Unprocessable Entity</code>: Input đúng schema nhưng business logic sai</li>
<li><code>500 Internal Server Error</code>: Lỗi hệ thống</li>
</ul>
</blockquote>
<hr />
<blockquote>
<p>🔁 <strong>Sự kiện phát ra (Pub/Sub Events):</strong></p>
<p>Các API dưới đây sẽ phát sự kiện tương ứng vào <code>PubSubEvents</code> để phục vụ mục đích logging/auditing:</p>
<table>
<thead>
<tr>
<th>API</th>
<th>Event Code</th>
<th>Ghi chú</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>POST /reports/query</code></td>
<td><code>report.query_logged</code></td>
<td>Ghi lại thông tin người dùng thực hiện truy vấn</td>
</tr>
<tr>
<td><code>POST /report-templates</code></td>
<td><code>report_template_created</code></td>
<td>Ghi lại metadata template</td>
</tr>
<tr>
<td><code>PATCH /report-templates/{id}</code></td>
<td><code>report_template_updated</code></td>
<td>Bao gồm version mới</td>
</tr>
<tr>
<td><code>DELETE /report-templates/{id}</code></td>
<td><code>report_template_disabled</code></td>
<td>Không xóa vật lý</td>
</tr>
<tr>
<td><code>POST /saved-configs</code></td>
<td><code>report_config_saved</code></td>
<td>Ghi lại cấu hình người dùng</td>
</tr>
<tr>
<td><code>DELETE /saved-configs/{id}</code></td>
<td><code>report_config_deleted</code></td>
<td>Ghi lại hành động</td>
</tr>
</tbody>
</table>
</blockquote>
<hr />
<h2 id="2-nhom-api-reports-truy-van-bao-cao">2. Nhóm API: <code>/reports</code> – Truy vấn báo cáo<a class="headerlink" href="#2-nhom-api-reports-truy-van-bao-cao" title="Permanent link">¶</a></h2>
<blockquote>
<p>Cho phép truy vấn báo cáo theo template đã được định nghĩa và input tùy chỉnh.<br />
Trả về dữ liệu tổng hợp từ Data Warehouse (BigQuery).</p>
</blockquote>
<h3 id="post-reportsquery"><code>POST /reports/query</code><a class="headerlink" href="#post-reportsquery" title="Permanent link">¶</a></h3>
<ul>
<li><strong>Mô tả:</strong> Thực thi một truy vấn báo cáo dựa trên report template và input parameters từ người dùng.</li>
<li><strong>Yêu cầu:</strong> Header chứa <code>Authorization</code>, <code>X-Tenant-ID</code>, và <code>Content-Type: application/json</code>.</li>
<li><strong>RBAC:</strong> Cần <code>x-required-permission</code> tương ứng với template (VD: <code>report.view_financial_summary</code>).</li>
</ul>
<h4 id="request-body">📥 Request Body<a class="headerlink" href="#request-body" title="Permanent link">¶</a></h4>
<div class="language-json highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="p">{</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="w">  </span><span class="nt">&quot;template_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;student_summary&quot;</span><span class="p">,</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="w">  </span><span class="nt">&quot;version&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="w">  </span><span class="nt">&quot;input_parameters&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="w">    </span><span class="nt">&quot;from_date&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2024-01-01&quot;</span><span class="p">,</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="w">    </span><span class="nt">&quot;to_date&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2024-01-31&quot;</span><span class="p">,</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="w">    </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;active&quot;</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="p">}</span>
</span></code></pre></div>
<h4 id="success-response-200-ok">📤 Success Response (200 OK)<a class="headerlink" href="#success-response-200-ok" title="Permanent link">¶</a></h4>
<div class="language-json highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="p">{</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="w">  </span><span class="nt">&quot;meta&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="w">    </span><span class="nt">&quot;trace_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;a1b2c3&quot;</span><span class="p">,</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="w">    </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2025-06-04T10:00:00Z&quot;</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="w">  </span><span class="p">},</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="w">  </span><span class="nt">&quot;data&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;date&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2024-01-01&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;total_students&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">234</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;date&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2024-01-02&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;total_students&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">241</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="w">  </span><span class="p">]</span>
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="p">}</span>
</span></code></pre></div>
<h4 id="error-responses">⚠️ Error Responses<a class="headerlink" href="#error-responses" title="Permanent link">¶</a></h4>
<table>
<thead>
<tr>
<th>HTTP Code</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>400</td>
<td>Input không hợp lệ hoặc thiếu input parameters bắt buộc</td>
</tr>
<tr>
<td>403</td>
<td>Không có permission truy cập template</td>
</tr>
<tr>
<td>404</td>
<td>Template ID không tồn tại</td>
</tr>
<tr>
<td>500</td>
<td>Lỗi xử lý hoặc truy vấn BigQuery thất bại</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="3-nhom-api-report-templates-quan-ly-mau-bao-cao">3. Nhóm API: <code>/report-templates</code> – Quản lý mẫu báo cáo<a class="headerlink" href="#3-nhom-api-report-templates-quan-ly-mau-bao-cao" title="Permanent link">¶</a></h2>
<blockquote>
<p>Cho phép quản trị viên hệ thống (Superadmin) tạo, cập nhật, và truy vấn các mẫu báo cáo (Report Templates).<br />
Đây là nền tảng để xây dựng báo cáo động.</p>
</blockquote>
<hr />
<h3 id="get-report-templates"><code>GET /report-templates</code><a class="headerlink" href="#get-report-templates" title="Permanent link">¶</a></h3>
<ul>
<li><strong>Mô tả:</strong> Lấy danh sách tất cả các report templates đang hoạt động.</li>
<li><strong>RBAC:</strong> Yêu cầu permission <code>report.view_templates</code>.</li>
</ul>
<h4 id="response">📤 Response<a class="headerlink" href="#response" title="Permanent link">¶</a></h4>
<div class="language-json highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="p">{</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="w">  </span><span class="nt">&quot;meta&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="w">    </span><span class="nt">&quot;trace_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;xyz123&quot;</span><span class="p">,</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="w">    </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2025-06-04T10:30:00Z&quot;</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="w">  </span><span class="p">},</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="w">  </span><span class="nt">&quot;data&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="w">      </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;student_summary&quot;</span><span class="p">,</span>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a><span class="w">      </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Tổng kết học sinh theo trạng thái&quot;</span><span class="p">,</span>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a><span class="w">      </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Hiển thị tổng số học sinh theo trạng thái mỗi ngày&quot;</span><span class="p">,</span>
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a><span class="w">      </span><span class="nt">&quot;version&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a><span class="w">      </span><span class="nt">&quot;active&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a><span class="w">  </span><span class="p">]</span>
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a><span class="p">}</span>
</span></code></pre></div>
<hr />
<h3 id="get-report-templatesid"><code>GET /report-templates/{id}</code><a class="headerlink" href="#get-report-templatesid" title="Permanent link">¶</a></h3>
<ul>
<li><strong>Mô tả:</strong> Truy vấn chi tiết một report template.</li>
<li><strong>RBAC:</strong> Yêu cầu <code>report.view_templates</code>.</li>
</ul>
<h4 id="response_1">📤 Response<a class="headerlink" href="#response_1" title="Permanent link">¶</a></h4>
<div class="language-json highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="p">{</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="w">  </span><span class="nt">&quot;meta&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;trace_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;abc123&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2025-06-04T10:35:00Z&quot;</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="w">  </span><span class="nt">&quot;data&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="w">    </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;student_summary&quot;</span><span class="p">,</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="w">    </span><span class="nt">&quot;version&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="w">    </span><span class="nt">&quot;input_parameters&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="w">      </span><span class="p">{</span>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="w">        </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;from_date&quot;</span><span class="p">,</span>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;date&quot;</span><span class="p">,</span>
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a><span class="w">        </span><span class="nt">&quot;required&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a><span class="w">        </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Từ ngày&quot;</span><span class="p">,</span>
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a><span class="w">        </span><span class="nt">&quot;default_value&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span>
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a><span class="w">    </span><span class="p">],</span>
</span><span id="__span-3-15"><a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a><span class="w">    </span><span class="nt">&quot;x-required-permission&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;report.view_student_summary&quot;</span>
</span><span id="__span-3-16"><a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-3-17"><a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a><span class="p">}</span>
</span></code></pre></div>
<hr />
<h3 id="post-report-templates"><code>POST /report-templates</code><a class="headerlink" href="#post-report-templates" title="Permanent link">¶</a></h3>
<ul>
<li><strong>Mô tả:</strong> Tạo mới một template.</li>
<li><strong>RBAC:</strong> Chỉ dành cho Superadmin – <code>report.manage_templates</code></li>
</ul>
<hr />
<h3 id="patch-report-templatesid"><code>PATCH /report-templates/{id}</code><a class="headerlink" href="#patch-report-templatesid" title="Permanent link">¶</a></h3>
<ul>
<li><strong>Mô tả:</strong> Cập nhật nội dung template hoặc metadata.</li>
<li><strong>Lưu ý:</strong> Version mới sẽ được tạo, version cũ vẫn được giữ lại nếu có saved reports đang sử dụng.</li>
<li><strong>RBAC:</strong> <code>report.manage_templates</code></li>
</ul>
<hr />
<h3 id="delete-report-templatesid"><code>DELETE /report-templates/{id}</code><a class="headerlink" href="#delete-report-templatesid" title="Permanent link">¶</a></h3>
<ul>
<li><strong>Mô tả:</strong> Vô hiệu hóa template (không xóa vật lý).</li>
<li><strong>RBAC:</strong> <code>report.manage_templates</code></li>
</ul>
<hr />
<h2 id="4-nhom-api-saved-configs-quan-ly-cau-hinh-bao-cao-ca-nhan-tuy-chon">4. Nhóm API: <code>/saved-configs</code> – Quản lý cấu hình báo cáo cá nhân (Tùy chọn)<a class="headerlink" href="#4-nhom-api-saved-configs-quan-ly-cau-hinh-bao-cao-ca-nhan-tuy-chon" title="Permanent link">¶</a></h2>
<blockquote>
<p>Cho phép người dùng (Superadmin) lưu lại các cấu hình truy vấn thường dùng để tái sử dụng sau này.<br />
Phục vụ chức năng “My Dashboard” hoặc “Saved Reports”.</p>
</blockquote>
<hr />
<h3 id="get-saved-configs"><code>GET /saved-configs</code><a class="headerlink" href="#get-saved-configs" title="Permanent link">¶</a></h3>
<ul>
<li><strong>Mô tả:</strong> Lấy danh sách cấu hình báo cáo đã lưu của người dùng hiện tại.</li>
<li><strong>RBAC:</strong> <code>report.view_saved_config</code></li>
</ul>
<h4 id="response_2">📤 Response<a class="headerlink" href="#response_2" title="Permanent link">¶</a></h4>
<div class="language-json highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="p">{</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="w">  </span><span class="nt">&quot;meta&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;trace_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;xyz&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2025-06-04T11:00:00Z&quot;</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="w">  </span><span class="nt">&quot;data&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="w">      </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;rpt001&quot;</span><span class="p">,</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="w">      </span><span class="nt">&quot;template_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;student_summary&quot;</span><span class="p">,</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="w">      </span><span class="nt">&quot;version&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="w">      </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Báo cáo học sinh tháng 1&quot;</span><span class="p">,</span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="w">      </span><span class="nt">&quot;input_parameters&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="w">        </span><span class="nt">&quot;from_date&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2024-01-01&quot;</span><span class="p">,</span>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a><span class="w">        </span><span class="nt">&quot;to_date&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2024-01-31&quot;</span>
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a><span class="w">      </span><span class="nt">&quot;created_at&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2025-05-01T10:00:00Z&quot;</span>
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-4-15"><a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a><span class="w">  </span><span class="p">]</span>
</span><span id="__span-4-16"><a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a><span class="p">}</span>
</span></code></pre></div>
<hr />
<h3 id="post-saved-configs"><code>POST /saved-configs</code><a class="headerlink" href="#post-saved-configs" title="Permanent link">¶</a></h3>
<ul>
<li><strong>Mô tả:</strong> Tạo mới một cấu hình báo cáo đã lưu.</li>
<li><strong>RBAC:</strong> <code>report.manage_saved_config</code></li>
</ul>
<h4 id="request-body_1">📥 Request Body<a class="headerlink" href="#request-body_1" title="Permanent link">¶</a></h4>
<div class="language-json highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="p">{</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="w">  </span><span class="nt">&quot;template_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;student_summary&quot;</span><span class="p">,</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="w">  </span><span class="nt">&quot;version&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="w">  </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Báo cáo học sinh tháng 1&quot;</span><span class="p">,</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="w">  </span><span class="nt">&quot;input_parameters&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="w">    </span><span class="nt">&quot;from_date&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2024-01-01&quot;</span><span class="p">,</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="w">    </span><span class="nt">&quot;to_date&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2024-01-31&quot;</span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="p">}</span>
</span></code></pre></div>
<hr />
<h3 id="delete-saved-configsid"><code>DELETE /saved-configs/{id}</code><a class="headerlink" href="#delete-saved-configsid" title="Permanent link">¶</a></h3>
<ul>
<li><strong>Mô tả:</strong> Xóa một cấu hình báo cáo đã lưu.</li>
<li><strong>RBAC:</strong> <code>report.manage_saved_config</code></li>
</ul>
<hr />
<h2 id="phu-luc">📎 Phụ lục<a class="headerlink" href="#phu-luc" title="Permanent link">¶</a></h2>
<h3 id="chuan-hoa-ma-loi-error-codes">📚 Chuẩn hóa mã lỗi (Error Codes)<a class="headerlink" href="#chuan-hoa-ma-loi-error-codes" title="Permanent link">¶</a></h3>
<p>Tất cả các mã lỗi (<code>error.code</code>) trong response phải tuân thủ theo chuẩn định danh namespace được mô tả tại:</p>
<ul>
<li><a href="../../../standards/error-codes/">Error Codes</a></li>
<li><a href="../../../ADR/adr-011-api-error-format/">ADR-011 Error Format</a></li>
</ul>
<p><strong>Yêu cầu bắt buộc:</strong></p>
<ul>
<li>
<p>Mã lỗi phải viết theo dạng <strong>snake_case</strong>, có <strong>namespace phân tách rõ ràng</strong>, ví dụ:</p>
</li>
<li>
<p><code>user.user_not_found</code></p>
</li>
<li><code>auth.invalid_token</code></li>
<li><code>common.validation_failed</code></li>
<li>
<p>Mỗi response lỗi (401, 403, 404, 422...) phải trả về đối tượng <code>ErrorEnvelope</code>, gồm 2 phần:</p>
</li>
<li>
<p><code>error</code> – chứa <code>code</code>, <code>message</code>, <code>details</code></p>
</li>
<li><code>meta</code> – chứa <code>trace_id</code>, <code>timestamp</code></li>
</ul>
<p><strong>Gợi ý thực hành:</strong></p>
<ul>
<li>Không dùng các mã lỗi chung chung như <code>"BAD_REQUEST"</code>, <code>"NOT_FOUND"</code>, <code>"FORBIDDEN"</code></li>
<li>Luôn khai báo ví dụ cụ thể (ví dụ trong <code>components/examples/</code> hoặc inline OpenAPI) để giúp dev hiểu nhanh</li>
<li>Tái sử dụng error namespace có sẵn từ <code>error-codes.md</code> hoặc khai báo namespace mới nếu cần</li>
</ul>
<h3 id="tai-lieu-lien-quan">📚 Tài liệu liên quan<a class="headerlink" href="#tai-lieu-lien-quan" title="Permanent link">¶</a></h3>
<ul>
<li><a href="../design/">Design Spec</a></li>
<li><a href="../data-model/">Data Model</a></li>
<li><a href="../openapi.yaml">OpenAPI Spec</a></li>
<li><a href="../../../ADR/adr-012-response-structure/">ADR-012 - Response Structure</a></li>
<li><a href="../../../ADR/adr-011-api-error-format/">ADR-011 - API Error Format</a></li>
<li><a href="../../../ADR/adr-029-report-template-schema/">ADR-029 - Report Template Schema</a></li>
<li><a href="../../../ADR/adr-007-rbac/">ADR-007 - RBAC Architecture</a></li>
<li><a href="../../../ADR/adr-028-reporting-architecture/">ADR-028 - Reporting Architecture</a></li>
<li><a href="../../../ADR/adr-030-event-schema-governance/">ADR-030 - Event Schema Governance</a></li>
<li><a href="../../../standards/error-codes/">Error Codes</a></li>
</ul>







  
  






                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Trở lại mục lục
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.top", "navigation.indexes", "search.suggest", "search.highlight", "content.code.annotate", "content.tabs.link"], "search": "../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "\u0110\u00e3 sao ch\u00e9p", "clipboard.copy": "Sao ch\u00e9p v\u00e0o b\u1ed9 nh\u1edb t\u1ea1m", "search.result.more.one": "1 t\u1eeb kh\u00e1c trong trang", "search.result.more.other": "# t\u1eeb kh\u00e1c trong trang", "search.result.none": "Kh\u00f4ng t\u00ecm th\u1ea5y t\u00e0i li\u1ec7u li\u00ean quan", "search.result.one": "1 t\u00e0i li\u1ec7u li\u00ean quan", "search.result.other": "# t\u00e0i li\u1ec7u li\u00ean quan", "search.result.placeholder": "Nh\u1eadp \u0111\u1ec3 b\u1eaft \u0111\u1ea7u t\u00ecm ki\u1ebfm", "search.result.term.missing": "Kh\u00f4ng", "select.version": "Ch\u1ecdn phi\u00ean b\u1ea3n"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
    
  </body>
</html>