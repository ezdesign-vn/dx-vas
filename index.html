
<!DOCTYPE html>

<html class="no-js" lang="vi">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="T√†i li·ªáu ki·∫øn tr√∫c v√† ph√°t tri·ªÉn cho d·ª± √°n Chuy·ªÉn ƒë·ªïi s·ªë Tr∆∞·ªùng Vi·ªát Anh." name="description"/>
<meta content="DX VAS Team" name="author"/>
<link href="https://ezdesign-vn.github.io/dx-vas/" rel="canonical"/>
<link href="architecture/system-diagrams/" rel="next"/>
<link href="assets/images/favicon.ico" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.6.14" name="generator"/>
<title>DX VAS - Docs</title>
<link href="assets/stylesheets/main.342714a4.min.css" rel="stylesheet"/>
<link href="assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
</head>
<body data-md-color-accent="pink" data-md-color-primary="indigo" data-md-color-scheme="default" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#dx-vas-platform-documentation-v2">
          B·ªè qua
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
<nav aria-label="ƒê·∫ßu trang" class="md-header__inner md-grid">
<a aria-label="DX VAS - Docs" class="md-header__button md-logo" data-md-component="logo" href="." title="DX VAS - Docs">
<img alt="logo" src="assets/images/logo.png"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            DX VAS - Docs
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Home
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="pink" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="indigo" data-md-color-scheme="default" id="__palette_0" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"></path></svg>
</label>
<input aria-label="Switch to light mode" class="md-option" data-md-color-accent="lime" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="blue" data-md-color-scheme="slate" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_0" hidden="" title="Switch to light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"></path></svg>
</label>
</form>
<script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="T√¨m ki·∫øm" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="T√¨m ki·∫øm" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
</label>
<nav aria-label="T√¨m ki·∫øm" class="md-search__options">
<button aria-label="Xo√°" class="md-search__icon md-icon" tabindex="-1" title="Xo√°" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
</button>
</nav>
<div class="md-search__suggest" data-md-component="search-suggest"></div>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/ezdesign-vn/dx-vas.git" title="Xem m√£ ngu·ªìn">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"></path></svg>
</div>
<div class="md-source__repository">
    ezdesign.vn/dx-vas
  </div>
</a>
</div>
</nav>
<nav aria-label="Tabs" class="md-tabs" data-md-component="tabs">
<div class="md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item md-tabs__item--active">
<a class="md-tabs__link" href=".">
        
  
  
    
  
  Home

      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="architecture/system-diagrams/">
          
  
  
    
  
  Ki·∫øn tr√∫c H·ªá th·ªëng

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="dev-guide/">
        
  
  
    
  
  H∆∞·ªõng d·∫´n Ph√°t tri·ªÉn

      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="services/">
        
  
  
    
  
  Thi·∫øt k·∫ø Services

      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="ADR/">
          
  
  
    
  
  Quy·∫øt ƒë·ªãnh Ki·∫øn tr√∫c (ADRs)

        </a>
</li>
</ul>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Thanh ƒëi·ªÅu h∆∞·ªõng" class="md-nav md-nav--primary md-nav--lifted" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="DX VAS - Docs" class="md-nav__button md-logo" data-md-component="logo" href="." title="DX VAS - Docs">
<img alt="logo" src="assets/images/logo.png"/>
</a>
    DX VAS - Docs
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/ezdesign-vn/dx-vas.git" title="Xem m√£ ngu·ªìn">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"></path></svg>
</div>
<div class="md-source__repository">
    ezdesign.vn/dx-vas
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    Home
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href=".">
<span class="md-ellipsis">
    Home
    
  </span>
</a>
<nav aria-label="M·ª•c l·ª•c" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      M·ª•c l·ª•c
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#1-vision-scope">
<span class="md-ellipsis">
      1. Vision &amp; Scope
    </span>
</a>
<nav aria-label="1. Vision &amp; Scope" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#tam-nhin">
<span class="md-ellipsis">
      üéØ T·∫ßm nh√¨n
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#pham-vi-tai-lieu">
<span class="md-ellipsis">
      üì¶ Ph·∫°m vi t√†i li·ªáu
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#oi-tuong-oc-gia">
<span class="md-ellipsis">
      üë• ƒê·ªëi t∆∞·ª£ng ƒë·ªôc gi·∫£
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ngoai-pham-vi">
<span class="md-ellipsis">
      üö´ Ngo√†i ph·∫°m vi
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#2-high-level-architecture">
<span class="md-ellipsis">
      2. High-Level Architecture
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#21-so-o-tong-quan-mermaid-khoi-mau-nhat-dich-vu-per-tenant">
<span class="md-ellipsis">
      2.1 S∆° ƒë·ªì t·ªïng quan (Mermaid) Kh·ªëi m√†u nh·∫°t = d·ªãch¬†v·ª• ‚Äúper tenant‚Äù.
    </span>
</a>
<nav aria-label="2.1 S∆° ƒë·ªì t·ªïng quan (Mermaid) Kh·ªëi m√†u nh·∫°t = d·ªãch¬†v·ª• ‚Äúper tenant‚Äù." class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#22-component-groups">
<span class="md-ellipsis">
      2.2 Component Groups
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#3-authentication-flow">
<span class="md-ellipsis">
      3. Authentication Flow
    </span>
</a>
<nav aria-label="3. Authentication Flow" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#31-cac-thanh-phan-tham-gia">
<span class="md-ellipsis">
      3.1 C√°c th√†nh ph·∫ßn tham gia
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#32-trinh-tu-ang-nhap-goi-api">
<span class="md-ellipsis">
      3.2 Tr√¨nh t·ª± ƒëƒÉng nh·∫≠p &amp; g·ªçi API
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#33-vong-oi-jwt">
<span class="md-ellipsis">
      3.3 V√≤ng ƒë·ªùi JWT
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#34-cau-truc-jwt-rs256">
<span class="md-ellipsis">
      3.4 C·∫•u tr√∫c JWT (RS256)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#35-bien-phap-bao-mat-bo-sung">
<span class="md-ellipsis">
      3.5 Bi·ªán ph√°p b·∫£o m·∫≠t b·ªï sung
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#4-token-service-jwt-lifecycle">
<span class="md-ellipsis">
      4. Token Service &amp; JWT Lifecycle
    </span>
</a>
<nav aria-label="4. Token Service &amp; JWT Lifecycle" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#41-vai-tro-ranh-gioi-tin-cay">
<span class="md-ellipsis">
      4.1 Vai tr√≤ &amp; Ranh gi·ªõi tin c·∫≠y
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#42-api-endpoints">
<span class="md-ellipsis">
      4.2 API Endpoints
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#43-key-management">
<span class="md-ellipsis">
      4.3 Key Management üîë
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#44-cau-truc-jwt-ttl">
<span class="md-ellipsis">
      4.4 C·∫•u tr√∫c JWT &amp; TTL
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#45-thu-hoi-token-redis-cache">
<span class="md-ellipsis">
      4.5 Thu h·ªìi token &amp; Redis Cache
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#46-event-publishing">
<span class="md-ellipsis">
      4.6 Event Publishing üì°
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#47-error-codes">
<span class="md-ellipsis">
      4.7 Error Codes
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#48-kpi-monitoring">
<span class="md-ellipsis">
      4.8 KPI &amp; Monitoring
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#5-tenant-stack-school-management-system-sms">
<span class="md-ellipsis">
      5. Tenant Stack &amp; School Management System (SMS)
    </span>
</a>
<nav aria-label="5. Tenant Stack &amp; School Management System (SMS)" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#51-khai-niem-tenant-stack">
<span class="md-ellipsis">
      5.1 Kh√°i ni·ªám Tenant Stack
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#52-luong-chinh">
<span class="md-ellipsis">
      5.2 Lu·ªìng ch√≠nh
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#53-loi-ich-kien-truc">
<span class="md-ellipsis">
      5.3 L·ª£i √≠ch ki·∫øn tr√∫c
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#54-chuan-trien-khai-versioning">
<span class="md-ellipsis">
      5.4 Chu·∫©n tri·ªÉn khai &amp; versioning
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#6-core-business-services">
<span class="md-ellipsis">
      6. Core &amp; Business Services
    </span>
</a>
<nav aria-label="6. Core &amp; Business Services" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#61-core-services-shared">
<span class="md-ellipsis">
      6.1 Core Services (Shared)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#62-business-services-per-tenant">
<span class="md-ellipsis">
      6.2 Business Services (per tenant)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#63-cross-cutting-infrastructure">
<span class="md-ellipsis">
      6.3 Cross-cutting &amp; Infrastructure
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#64-uu-tien-phat-trien-roadmap">
<span class="md-ellipsis">
      6.4 ∆Øu ti√™n ph√°t tri·ªÉn (Roadmap)
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#7-observability-security">
<span class="md-ellipsis">
      7. Observability &amp; Security
    </span>
</a>
<nav aria-label="7. Observability &amp; Security" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#71-observability">
<span class="md-ellipsis">
      7.1 Observability üîç
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#72-security">
<span class="md-ellipsis">
      7.2 Security üõ°Ô∏è
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#73-alert-routing-escalation">
<span class="md-ellipsis">
      7.3 Alert Routing &amp; Escalation
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#8-cicd-deployment">
<span class="md-ellipsis">
      8. CI/CD &amp; Deployment
    </span>
</a>
<nav aria-label="8. CI/CD &amp; Deployment" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#81-nhanh-ma-chinh-sach-pr">
<span class="md-ellipsis">
      8.1 Nh√°nh m√£ &amp; Ch√≠nh s√°ch PR
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#82-pipeline-ci-github-actions">
<span class="md-ellipsis">
      8.2 Pipeline CI (GitHub Actions)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#83-pipeline-cd-argo-cd-terraform-cloud">
<span class="md-ellipsis">
      8.3 Pipeline CD (Argo CD + Terraform Cloud)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#84-zero-downtime-chien-luoc-trien-khai">
<span class="md-ellipsis">
      8.4 Zero-Downtime &amp; Chi·∫øn l∆∞·ª£c Tri·ªÉn khai
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#85-tenant-on-boarding-pipeline">
<span class="md-ellipsis">
      8.5 Tenant On-Boarding Pipeline
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#86-quan-ly-cau-hinh-secrets">
<span class="md-ellipsis">
      8.6 Qu·∫£n l√Ω C·∫•u h√¨nh &amp; Secrets
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#87-kiem-soat-chi-phi-carbon">
<span class="md-ellipsis">
      8.7 Ki·ªÉm so√°t Chi ph√≠ &amp; Carbon
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#88-so-o-luong-cicd-tong-quan">
<span class="md-ellipsis">
      8.8 S∆° ƒë·ªì lu·ªìng CI/CD t·ªïng quan
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#9-data-reporting">
<span class="md-ellipsis">
      9. Data &amp; Reporting
    </span>
</a>
<nav aria-label="9. Data &amp; Reporting" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#91-nguon-du-lieu-goc-source-of-truth">
<span class="md-ellipsis">
      9.1 Ngu·ªìn d·ªØ li·ªáu g·ªëc (Source-of-Truth)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#92-elt-pipeline-near-real-time">
<span class="md-ellipsis">
      9.2 ELT Pipeline (near-real-time)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#93-thiet-ke-data-warehouse">
<span class="md-ellipsis">
      9.3 Thi·∫øt k·∫ø Data Warehouse
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#94-bao-cao-bi">
<span class="md-ellipsis">
      9.4 B√°o c√°o &amp; BI
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#95-data-governance-compliance">
<span class="md-ellipsis">
      9.5 Data Governance &amp; Compliance
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#96-quan-sat-sla-du-lieu">
<span class="md-ellipsis">
      9.6 Quan s√°t &amp; SLA d·ªØ li·ªáu
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#97-tich-hop-event-schema-governance">
<span class="md-ellipsis">
      9.7 T√≠ch h·ª£p Event Schema Governance
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#10-adr-cr-index">
<span class="md-ellipsis">
      10. ADR &amp; CR Index
    </span>
</a>
<nav aria-label="10. ADR &amp; CR Index" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#101-architecture-decision-records-adr">
<span class="md-ellipsis">
      10.1 Architecture Decision Records (ADR)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#102-change-requests-cr">
<span class="md-ellipsis">
      10.2 Change Requests (CR)
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#11-standards-conventions">
<span class="md-ellipsis">
      11. Standards &amp; Conventions
    </span>
</a>
<nav aria-label="11. Standards &amp; Conventions" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#111-bo-tieu-chuan-5-5-star-standards">
<span class="md-ellipsis">
      11.1 B·ªô ti√™u chu·∫©n ‚Äú5‚òÖ‚Äù (5-Star Standards)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#112-error-codes-envelope">
<span class="md-ellipsis">
      11.2 Error Codes &amp; Envelope
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#113-naming-versioning">
<span class="md-ellipsis">
      11.3 Naming &amp; Versioning
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#114-style-guide-code-docs">
<span class="md-ellipsis">
      11.4 Style Guide (Code &amp; Docs)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#115-kiem-tra-tuan-thu-ci-checks">
<span class="md-ellipsis">
      11.5 Ki·ªÉm tra tu√¢n th·ªß (CI Checks)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#116-ngoai-le-quy-trinh-phe-duyet">
<span class="md-ellipsis">
      11.6 Ngo·∫°i l·ªá &amp; Quy tr√¨nh ph√™ duy·ªát
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#12-appendix">
<span class="md-ellipsis">
      12. Appendix
    </span>
</a>
<nav aria-label="12. Appendix" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#121-thuat-ngu-glossary">
<span class="md-ellipsis">
      12.1 Thu·∫≠t ng·ªØ (Glossary)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#122-danh-ba-contacts">
<span class="md-ellipsis">
      12.2 Danh b·∫° (Contacts)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#123-changelog-tom-tat">
<span class="md-ellipsis">
      12.3 Changelog (T√≥m t·∫Øt)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#124-tai-lieu-bo-sung">
<span class="md-ellipsis">
      12.4 T√†i li·ªáu b·ªï sung
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
<span class="md-ellipsis">
    Ki·∫øn tr√∫c H·ªá th·ªëng
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
            Ki·∫øn tr√∫c H·ªá th·ªëng
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="architecture/system-diagrams/">
<span class="md-ellipsis">
    S∆° ƒë·ªì H·ªá th·ªëng
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="architecture/rbac-deep-dive/">
<span class="md-ellipsis">
    RBAC Chi ti·∫øt
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="dev-guide/">
<span class="md-ellipsis">
    H∆∞·ªõng d·∫´n Ph√°t tri·ªÉn
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="services/">
<span class="md-ellipsis">
    Thi·∫øt k·∫ø Services
    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_5" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="ADR/">
<span class="md-ellipsis">
    Quy·∫øt ƒë·ªãnh Ki·∫øn tr√∫c (ADRs)
    
  </span>
</a>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_5_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
            Quy·∫øt ƒë·ªãnh Ki·∫øn tr√∫c (ADRs)
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="M·ª•c l·ª•c" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      M·ª•c l·ª•c
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#1-vision-scope">
<span class="md-ellipsis">
      1. Vision &amp; Scope
    </span>
</a>
<nav aria-label="1. Vision &amp; Scope" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#tam-nhin">
<span class="md-ellipsis">
      üéØ T·∫ßm nh√¨n
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#pham-vi-tai-lieu">
<span class="md-ellipsis">
      üì¶ Ph·∫°m vi t√†i li·ªáu
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#oi-tuong-oc-gia">
<span class="md-ellipsis">
      üë• ƒê·ªëi t∆∞·ª£ng ƒë·ªôc gi·∫£
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ngoai-pham-vi">
<span class="md-ellipsis">
      üö´ Ngo√†i ph·∫°m vi
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#2-high-level-architecture">
<span class="md-ellipsis">
      2. High-Level Architecture
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#21-so-o-tong-quan-mermaid-khoi-mau-nhat-dich-vu-per-tenant">
<span class="md-ellipsis">
      2.1 S∆° ƒë·ªì t·ªïng quan (Mermaid) Kh·ªëi m√†u nh·∫°t = d·ªãch¬†v·ª• ‚Äúper tenant‚Äù.
    </span>
</a>
<nav aria-label="2.1 S∆° ƒë·ªì t·ªïng quan (Mermaid) Kh·ªëi m√†u nh·∫°t = d·ªãch¬†v·ª• ‚Äúper tenant‚Äù." class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#22-component-groups">
<span class="md-ellipsis">
      2.2 Component Groups
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#3-authentication-flow">
<span class="md-ellipsis">
      3. Authentication Flow
    </span>
</a>
<nav aria-label="3. Authentication Flow" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#31-cac-thanh-phan-tham-gia">
<span class="md-ellipsis">
      3.1 C√°c th√†nh ph·∫ßn tham gia
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#32-trinh-tu-ang-nhap-goi-api">
<span class="md-ellipsis">
      3.2 Tr√¨nh t·ª± ƒëƒÉng nh·∫≠p &amp; g·ªçi API
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#33-vong-oi-jwt">
<span class="md-ellipsis">
      3.3 V√≤ng ƒë·ªùi JWT
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#34-cau-truc-jwt-rs256">
<span class="md-ellipsis">
      3.4 C·∫•u tr√∫c JWT (RS256)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#35-bien-phap-bao-mat-bo-sung">
<span class="md-ellipsis">
      3.5 Bi·ªán ph√°p b·∫£o m·∫≠t b·ªï sung
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#4-token-service-jwt-lifecycle">
<span class="md-ellipsis">
      4. Token Service &amp; JWT Lifecycle
    </span>
</a>
<nav aria-label="4. Token Service &amp; JWT Lifecycle" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#41-vai-tro-ranh-gioi-tin-cay">
<span class="md-ellipsis">
      4.1 Vai tr√≤ &amp; Ranh gi·ªõi tin c·∫≠y
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#42-api-endpoints">
<span class="md-ellipsis">
      4.2 API Endpoints
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#43-key-management">
<span class="md-ellipsis">
      4.3 Key Management üîë
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#44-cau-truc-jwt-ttl">
<span class="md-ellipsis">
      4.4 C·∫•u tr√∫c JWT &amp; TTL
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#45-thu-hoi-token-redis-cache">
<span class="md-ellipsis">
      4.5 Thu h·ªìi token &amp; Redis Cache
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#46-event-publishing">
<span class="md-ellipsis">
      4.6 Event Publishing üì°
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#47-error-codes">
<span class="md-ellipsis">
      4.7 Error Codes
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#48-kpi-monitoring">
<span class="md-ellipsis">
      4.8 KPI &amp; Monitoring
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#5-tenant-stack-school-management-system-sms">
<span class="md-ellipsis">
      5. Tenant Stack &amp; School Management System (SMS)
    </span>
</a>
<nav aria-label="5. Tenant Stack &amp; School Management System (SMS)" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#51-khai-niem-tenant-stack">
<span class="md-ellipsis">
      5.1 Kh√°i ni·ªám Tenant Stack
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#52-luong-chinh">
<span class="md-ellipsis">
      5.2 Lu·ªìng ch√≠nh
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#53-loi-ich-kien-truc">
<span class="md-ellipsis">
      5.3 L·ª£i √≠ch ki·∫øn tr√∫c
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#54-chuan-trien-khai-versioning">
<span class="md-ellipsis">
      5.4 Chu·∫©n tri·ªÉn khai &amp; versioning
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#6-core-business-services">
<span class="md-ellipsis">
      6. Core &amp; Business Services
    </span>
</a>
<nav aria-label="6. Core &amp; Business Services" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#61-core-services-shared">
<span class="md-ellipsis">
      6.1 Core Services (Shared)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#62-business-services-per-tenant">
<span class="md-ellipsis">
      6.2 Business Services (per tenant)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#63-cross-cutting-infrastructure">
<span class="md-ellipsis">
      6.3 Cross-cutting &amp; Infrastructure
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#64-uu-tien-phat-trien-roadmap">
<span class="md-ellipsis">
      6.4 ∆Øu ti√™n ph√°t tri·ªÉn (Roadmap)
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#7-observability-security">
<span class="md-ellipsis">
      7. Observability &amp; Security
    </span>
</a>
<nav aria-label="7. Observability &amp; Security" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#71-observability">
<span class="md-ellipsis">
      7.1 Observability üîç
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#72-security">
<span class="md-ellipsis">
      7.2 Security üõ°Ô∏è
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#73-alert-routing-escalation">
<span class="md-ellipsis">
      7.3 Alert Routing &amp; Escalation
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#8-cicd-deployment">
<span class="md-ellipsis">
      8. CI/CD &amp; Deployment
    </span>
</a>
<nav aria-label="8. CI/CD &amp; Deployment" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#81-nhanh-ma-chinh-sach-pr">
<span class="md-ellipsis">
      8.1 Nh√°nh m√£ &amp; Ch√≠nh s√°ch PR
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#82-pipeline-ci-github-actions">
<span class="md-ellipsis">
      8.2 Pipeline CI (GitHub Actions)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#83-pipeline-cd-argo-cd-terraform-cloud">
<span class="md-ellipsis">
      8.3 Pipeline CD (Argo CD + Terraform Cloud)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#84-zero-downtime-chien-luoc-trien-khai">
<span class="md-ellipsis">
      8.4 Zero-Downtime &amp; Chi·∫øn l∆∞·ª£c Tri·ªÉn khai
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#85-tenant-on-boarding-pipeline">
<span class="md-ellipsis">
      8.5 Tenant On-Boarding Pipeline
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#86-quan-ly-cau-hinh-secrets">
<span class="md-ellipsis">
      8.6 Qu·∫£n l√Ω C·∫•u h√¨nh &amp; Secrets
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#87-kiem-soat-chi-phi-carbon">
<span class="md-ellipsis">
      8.7 Ki·ªÉm so√°t Chi ph√≠ &amp; Carbon
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#88-so-o-luong-cicd-tong-quan">
<span class="md-ellipsis">
      8.8 S∆° ƒë·ªì lu·ªìng CI/CD t·ªïng quan
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#9-data-reporting">
<span class="md-ellipsis">
      9. Data &amp; Reporting
    </span>
</a>
<nav aria-label="9. Data &amp; Reporting" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#91-nguon-du-lieu-goc-source-of-truth">
<span class="md-ellipsis">
      9.1 Ngu·ªìn d·ªØ li·ªáu g·ªëc (Source-of-Truth)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#92-elt-pipeline-near-real-time">
<span class="md-ellipsis">
      9.2 ELT Pipeline (near-real-time)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#93-thiet-ke-data-warehouse">
<span class="md-ellipsis">
      9.3 Thi·∫øt k·∫ø Data Warehouse
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#94-bao-cao-bi">
<span class="md-ellipsis">
      9.4 B√°o c√°o &amp; BI
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#95-data-governance-compliance">
<span class="md-ellipsis">
      9.5 Data Governance &amp; Compliance
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#96-quan-sat-sla-du-lieu">
<span class="md-ellipsis">
      9.6 Quan s√°t &amp; SLA d·ªØ li·ªáu
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#97-tich-hop-event-schema-governance">
<span class="md-ellipsis">
      9.7 T√≠ch h·ª£p Event Schema Governance
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#10-adr-cr-index">
<span class="md-ellipsis">
      10. ADR &amp; CR Index
    </span>
</a>
<nav aria-label="10. ADR &amp; CR Index" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#101-architecture-decision-records-adr">
<span class="md-ellipsis">
      10.1 Architecture Decision Records (ADR)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#102-change-requests-cr">
<span class="md-ellipsis">
      10.2 Change Requests (CR)
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#11-standards-conventions">
<span class="md-ellipsis">
      11. Standards &amp; Conventions
    </span>
</a>
<nav aria-label="11. Standards &amp; Conventions" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#111-bo-tieu-chuan-5-5-star-standards">
<span class="md-ellipsis">
      11.1 B·ªô ti√™u chu·∫©n ‚Äú5‚òÖ‚Äù (5-Star Standards)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#112-error-codes-envelope">
<span class="md-ellipsis">
      11.2 Error Codes &amp; Envelope
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#113-naming-versioning">
<span class="md-ellipsis">
      11.3 Naming &amp; Versioning
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#114-style-guide-code-docs">
<span class="md-ellipsis">
      11.4 Style Guide (Code &amp; Docs)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#115-kiem-tra-tuan-thu-ci-checks">
<span class="md-ellipsis">
      11.5 Ki·ªÉm tra tu√¢n th·ªß (CI Checks)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#116-ngoai-le-quy-trinh-phe-duyet">
<span class="md-ellipsis">
      11.6 Ngo·∫°i l·ªá &amp; Quy tr√¨nh ph√™ duy·ªát
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#12-appendix">
<span class="md-ellipsis">
      12. Appendix
    </span>
</a>
<nav aria-label="12. Appendix" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#121-thuat-ngu-glossary">
<span class="md-ellipsis">
      12.1 Thu·∫≠t ng·ªØ (Glossary)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#122-danh-ba-contacts">
<span class="md-ellipsis">
      12.2 Danh b·∫° (Contacts)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#123-changelog-tom-tat">
<span class="md-ellipsis">
      12.3 Changelog (T√≥m t·∫Øt)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#124-tai-lieu-bo-sung">
<span class="md-ellipsis">
      12.4 T√†i li·ªáu b·ªï sung
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<!-- docs/README.v2.md -->
<h1 id="dx-vas-platform-documentation-v2">DX-VAS Platform ‚Äì Documentation (v2)<a class="headerlink" href="#dx-vas-platform-documentation-v2" title="Permanent link">¬∂</a></h1>
<hr/>
<h2 id="1-vision-scope">1. Vision &amp; Scope<a class="headerlink" href="#1-vision-scope" title="Permanent link">¬∂</a></h2>
<h3 id="tam-nhin">üéØ T·∫ßm nh√¨n<a class="headerlink" href="#tam-nhin" title="Permanent link">¬∂</a></h3>
<p>X√¢y d·ª±ng <strong>DX-VAS Platform</strong> th√†nh m·ªôt n·ªÅn t·∫£ng <strong>chuy·ªÉn ƒë·ªïi s·ªë ‚Äút·∫•t-c·∫£-trong-m·ªôt‚Äù</strong> cho h·ªá sinh th√°i Tr∆∞·ªùng Vi·ªát Anh, ƒë√°p ·ª©ng ba m·ª•c ti√™u c·ªët l√µi:</p>
<ol>
<li><strong>K·∫øt n·ªëi li·ªÅn m·∫°ch</strong> ‚Äì H·ª£p nh·∫•t quy tr√¨nh gi√°o d·ª•c, v·∫≠n h√†nh tr∆∞·ªùng h·ªçc v√† t∆∞∆°ng t√°c ph·ª• huynh-h·ªçc sinh tr√™n m·ªôt n·ªÅn t·∫£ng duy nh·∫•t.  </li>
<li><strong>M·ªü r·ªông linh ho·∫°t</strong> ‚Äì Ki·∫øn tr√∫c <strong>multi-tenant</strong> cho ph√©p tri·ªÉn khai nhanh nhi·ªÅu c∆° s·ªü/tr∆∞·ªùng, m·ªói tenant t·ª± ch·ªß nh∆∞ng k·∫ø th·ª´a d·ªãch v·ª• chung.  </li>
<li><strong>B·ªÅn v·ªØng &amp; b·∫£o m·∫≠t</strong> ‚Äì √Åp d·ª•ng chu·∫©n 5‚òÖ (Service, Data, Interface, OpenAPI, Security) v√† tu√¢n th·ªß c√°c ADR ƒë·ªÉ ƒë·∫£m b·∫£o b·∫£o m·∫≠t, kh·∫£ nƒÉng quan s√°t, v√† ti·∫øt ki·ªám chi ph√≠ d√†i h·∫°n.</li>
<li>H·ªá th·ªëng h·ªó tr·ª£ ƒëa d·∫°ng ph∆∞∆°ng th·ª©c ƒëƒÉng nh·∫≠p:</li>
<li>OAuth2 (Google): D√†nh cho gi√°o vi√™n, h·ªçc sinh, nh√¢n vi√™n ‚Äì x√°c th·ª±c qua <code>auth-service/master</code>.</li>
<li>Local/OTP: D√†nh cho ph·ª• huynh v√† tr∆∞·ªùng kh√¥ng d√πng Google Workspace ‚Äì x·ª≠ l√Ω qua <code>auth-service/sub</code> v√† reCAPTCHA.</li>
</ol>
<h3 id="pham-vi-tai-lieu">üì¶ Ph·∫°m vi t√†i li·ªáu<a class="headerlink" href="#pham-vi-tai-lieu" title="Permanent link">¬∂</a></h3>
<p>T√†i li·ªáu n√†y m√¥ t·∫£ <strong>to√†n b·ªô ki·∫øn tr√∫c v√† ti√™u chu·∫©n k·ªπ thu·∫≠t</strong> c·ªßa DX-VAS:</p>
<table>
<thead>
<tr>
<th>M·∫£ng</th>
<th>N·ªôi dung ch√≠nh</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Ki·∫øn tr√∫c t·ªïng quan</strong></td>
<td>S∆° ƒë·ªì h·ªá th·ªëng, th√†nh ph·∫ßn, lu·ªìng d·ªØ li·ªáu</td>
</tr>
<tr>
<td><strong>Authentication &amp; Token</strong></td>
<td>Auth Master/Sub, Token Service, JWT lifecycle</td>
</tr>
<tr>
<td><strong>Tenant Stack &amp; SMS</strong></td>
<td>M√¥ h√¨nh School Management System cho t·ª´ng tenant</td>
</tr>
<tr>
<td><strong>Core/Business Services</strong></td>
<td>API Gateway, User, Notification, SMS,‚Ä¶</td>
</tr>
<tr>
<td><strong>Observability &amp; Security</strong></td>
<td>Log-tracing, JWKS, key rotation, error codes</td>
</tr>
<tr>
<td><strong>CI/CD &amp; Deployment</strong></td>
<td>Pipeline, auto-scaling, zero-downtime, on-boarding tenant</td>
</tr>
<tr>
<td><strong>Data &amp; Reporting</strong></td>
<td>ELT, event schema governance, b√°o c√°o ph√¢n t√≠ch</td>
</tr>
<tr>
<td><strong>Standards &amp; ADR/CR</strong></td>
<td>5‚òÖ standards, 30 ADR, c√°c Change Request hi·ªán h√†nh</td>
</tr>
</tbody>
</table>
<h3 id="oi-tuong-oc-gia">üë• ƒê·ªëi t∆∞·ª£ng ƒë·ªôc gi·∫£<a class="headerlink" href="#oi-tuong-oc-gia" title="Permanent link">¬∂</a></h3>
<ul>
<li><strong>K·ªπ s∆∞ ph√°t tri·ªÉn</strong> (backend/frontend, ML, mobile)  </li>
<li><strong>DevOps &amp; SRE</strong> ‚Äì tri·ªÉn khai, v·∫≠n h√†nh, gi√°m s√°t  </li>
<li><strong>Ki·∫øn tr√∫c s∆∞ h·ªá th·ªëng</strong> ‚Äì th·∫©m ƒë·ªãnh, m·ªü r·ªông ki·∫øn tr√∫c  </li>
<li><strong>Qu·∫£n l√Ω s·∫£n ph·∫©m &amp; ban l√£nh ƒë·∫°o</strong> ‚Äì n·∫Øm b·ª©c tranh t·ªïng quan v√† roadmap k·ªπ thu·∫≠t</li>
</ul>
<h3 id="ngoai-pham-vi">üö´ Ngo√†i ph·∫°m vi<a class="headerlink" href="#ngoai-pham-vi" title="Permanent link">¬∂</a></h3>
<ul>
<li>Chi·∫øn l∆∞·ª£c s∆∞ ph·∫°m, n·ªôi dung gi·∫£ng d·∫°y.  </li>
<li>H∆∞·ªõng d·∫´n chi ti·∫øt UI/UX cho t·ª´ng portal (ƒë∆∞·ª£c t√†i li·ªáu ri√™ng).  </li>
<li>B√°o c√°o t√†i ch√≠nh v√† d·ªØ li·ªáu PII c·ª• th·ªÉ (ch·ªâ n√™u nguy√™n t·∫Øc x·ª≠ l√Ω).</li>
</ul>
<blockquote>
<p><strong>K·∫øt qu·∫£ mong ƒë·ª£i:</strong> Sau khi ƒë·ªçc xong ph·∫ßn Vision &amp; Scope, ƒë·ªôc gi·∫£ hi·ªÉu <em>‚Äút·∫°i sao‚Äù</em> v√† <em>‚Äút√†i li·ªáu n√†y bao tr√πm nh·ªØng g√¨‚Äù</em> tr∆∞·ªõc khi ƒëi s√¢u v√†o chi ti·∫øt k·ªπ thu·∫≠t.</p>
</blockquote>
<hr/>
<h2 id="2-high-level-architecture">2. High-Level Architecture<a class="headerlink" href="#2-high-level-architecture" title="Permanent link">¬∂</a></h2>
<h2 id="21-so-o-tong-quan-mermaid-khoi-mau-nhat-dich-vu-per-tenant">2.1 S∆° ƒë·ªì t·ªïng quan (Mermaid) <sup><sub><em>Kh·ªëi m√†u nh·∫°t = d·ªãch¬†v·ª• ‚Äúper tenant‚Äù.</em></sub></sup><a class="headerlink" href="#21-so-o-tong-quan-mermaid-khoi-mau-nhat-dich-vu-per-tenant" title="Permanent link">¬∂</a></h2>
<pre class="mermaid"><code>flowchart TD
  %% ======= EXTERNAL =======
  subgraph ext ["üåê External IdP &amp; Channels"]
    GoogleOAuth(Google OAuth2)
    OTPProv(OTP Provider)
    EmailSvc(Email Gateway)
    SMSSvc(SMS Gateway)
  end

  %% ======= FRONTEND =======
  subgraph fe ["üíª Frontend Apps"]
    AdminPortal(Admin Portal)
    TeacherPortal(Teacher Portal)
    StudentPortal(Student Portal)
    ParentPortal(Parent Portal)
  end

  %% ======= CORE SERVICES =======
  subgraph core ["üîß Core Services (Shared)"]
    APIGW(API Gateway)
    TokenSvc(Token Service)
    AuthM(Auth Master)
    UserM(User Master)
    NotifM(Notification Master)
    RedisRev[Redis<br/>revoked_tokens cache]
    ReportSvc(Reporting Service)
    AuditLog(Audit Logging Service)
    PubSub((Pub / Sub))
  end

  %% ======= DATA PLATFORM =======
  subgraph db ["üîß Data Platform"]
    BQ(Data Warehouse)
  end

  %% ======= MONITORING STACK =======
  subgraph mon ["üìà Monitoring Stack"]
    CloudLog(Cloud Logging)
    CloudMon(Cloud Monitoring)
    AlertSys(Alerting Rules)
  end

  %% ======= CI / CONTRACT TESTING =======
  subgraph test ["üß™ CI / Contract Testing"]
    CIPipeline(CI/CD Pipeline)
    ContractEngine(Contract Test Engine)
    MockUser(Mock: User Service)
    MockNotif(Mock: Notif Service)
    MockAuth(Mock: Auth Service)
  end

  %% ======= TENANT STACK EXAMPLE =======
  subgraph tenantA ["üè´ Tenant Stack ¬∑ ABC School"]
    subgraph smsgrp ["School Management System (SMS)"]
      SMS(SMS Backend<br/>+ MariaDB)
    end
    AuthSub(Auth Sub)
    UserSub(User Sub)
    NotifSub(Notif Sub)
  end

  %% ======= FLOWS =======
  %% Front-door
  AdminPortal -. https .-&gt; APIGW
  TeacherPortal -. https .-&gt; APIGW
  StudentPortal -. https .-&gt; APIGW
  ParentPortal  -. https .-&gt; APIGW

  %% Auth &amp; Token
  APIGW --&gt;|/login| AuthM
  AuthM --&gt;|/token/issue| TokenSvc
  AuthSub --&gt;|/token/issue| TokenSvc
  TokenSvc -- JWKS --&gt; APIGW

  %% Revoked-token check
  APIGW --&gt;|check revoked| RedisRev
  TokenSvc --&gt;|sync revoked| RedisRev

  %% Core routing
  APIGW ==&gt; UserM
  APIGW ==&gt; NotifM
  APIGW ==&gt; ReportSvc
  APIGW ==&gt; AuditLog

  %% Tenant routing
  APIGW ==&gt; AuthSub
  APIGW ==&gt; UserSub
  APIGW ==&gt; NotifSub
  APIGW ==&gt; SMS

  %% Event fan-out
  UserM -- "user.*" --&gt; PubSub
  NotifM -- "notif.*" --&gt; PubSub
  PubSub -- "user.*" --&gt; UserSub
  PubSub -- "notif.*" --&gt; NotifSub

  %% ELT (simplified)
  SMS -- "ELT" --&gt; BQ

  %% Audit Logging
  AuthM --&gt;|log login| AuditLog
  TokenSvc --&gt;|log issue/revoke| AuditLog
  UserM --&gt;|log user change| AuditLog
  NotifM --&gt;|log notif trigger| AuditLog
  ReportSvc --&gt;|log report access| AuditLog
  AuthSub --&gt;|log local login| AuditLog
  UserSub --&gt;|log role update| AuditLog
  NotifSub --&gt;|log delivery| AuditLog

  %% Monitoring Stack
  APIGW --&gt; CloudLog
  AuthM --&gt; CloudLog
  TokenSvc --&gt; CloudLog
  UserM --&gt; CloudLog
  ReportSvc --&gt; CloudLog
  AuditLog --&gt; CloudLog
  AuthSub --&gt; CloudLog
  UserSub --&gt; CloudLog
  SMS --&gt; CloudLog
  NotifSub --&gt; CloudLog
  CloudLog --&gt; CloudMon
  CloudMon --&gt; AlertSys

  %% CI/CD &amp; Contract Testing
  CIPipeline --&gt; ContractEngine
  ContractEngine --&gt; MockUser
  ContractEngine --&gt; MockNotif
  ContractEngine --&gt; MockAuth
  MockUser --&gt;|simulate calls| APIGW
  MockNotif --&gt;|simulate notif| APIGW
  MockAuth --&gt;|simulate login| APIGW
</code></pre>
<h4 id="chu-thich-quan-trong">üìù Ch√∫ th√≠ch quan tr·ªçng<a class="headerlink" href="#chu-thich-quan-trong" title="Permanent link">¬∂</a></h4>
<ol>
<li><strong>API Gateway</strong> x√°c th·ª±c JWT <strong>offline</strong> qua <strong>JWKS</strong> (RS256); ch·ªâ g·ªçi Token Service khi c·∫ßn ki·ªÉm tra <strong>revoked token</strong> (tra Redis) ho·∫∑c c√°c tr∆∞·ªùng h·ª£p ƒë·∫∑c bi·ªát. </li>
<li><strong>Redis</strong> l∆∞u cache <code>revoked_tokens</code> (TTL 15 ph√∫t). Token Service ƒë·ªìng b·ªô cache m·ªói khi thu h·ªìi token.</li>
<li><strong>User Sub</strong> &amp; <strong>Notif Sub</strong> l√† <strong>read-replica</strong>; d·ªØ li·ªáu ƒë·ªìng b·ªô b·∫•t ƒë·ªìng b·ªô t·ª´ c√°c service Master qua <strong>Pub/Sub</strong>.</li>
<li><strong>SMS</strong> l√† ngu·ªìn d·ªØ li·ªáu ch√≠nh cho b√°o c√°o; d·ªØ li·ªáu ƒë∆∞·ª£c tr√≠ch xu·∫•t v√†o <strong>Data Warehouse</strong> qua ƒë∆∞·ªùng <strong>ELT</strong> r·ªìi ti√™u th·ª• b·ªüi <strong>Reporting Service</strong>. </li>
<li>
<p><strong>ƒê·ªãnh nghƒ©a ƒë∆∞·ªùng n·ªëi</strong></p>
</li>
<li>
<p><code>-. https .-&gt;</code>  : G·ªçi HTTPS t·ª´ frontend b√™n ngo√†i</p>
</li>
<li><code>--&gt;</code>  : G·ªçi API ƒë·ªìng b·ªô n·ªôi b·ªô</li>
<li><code>==&gt;</code>  : G·ªçi API ƒë·ªìng b·ªô ∆∞u ti√™n cao (core routing)</li>
<li><code>..&gt;</code>  : Lu·ªìng b·∫•t ƒë·ªìng b·ªô (Pub/Sub, ELT)</li>
</ol>
<blockquote>
<p>S∆° ƒë·ªì n√†y ph·∫£n √°nh ƒë·∫ßy ƒë·ªß hai Change Request: <strong>Token Service centralization</strong> v√† <strong>Tenant Stack/SMS simplification</strong>.</p>
</blockquote>
<hr/>
<h3 id="22-component-groups">2.2 Component Groups<a class="headerlink" href="#22-component-groups" title="Permanent link">¬∂</a></h3>
<table>
<thead>
<tr>
<th>Nh√≥m th√†nh ph·∫ßn</th>
<th>M√¥ t·∫£ ng·∫Øn</th>
<th>Ghi ch√∫</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>1. External IdP &amp; Channels</strong></td>
<td>Google OAuth2, OTP Provider, Email/SMS Gateway.</td>
<td>N·∫±m ngo√†i h·∫° t·∫ßng dx-vas; ƒë∆∞·ª£c t√≠ch h·ª£p qua HTTPS (OAuth2, REST).</td>
</tr>
<tr>
<td><strong>2. Frontend Apps / Portals</strong></td>
<td>4 c·ªïng web/mobile: <strong>Admin</strong>, <strong>Teacher</strong>, <strong>Student</strong>, <strong>Parent</strong>.</td>
<td>G·ªçi API Gateway duy nh·∫•t b·∫±ng HTTPS.</td>
</tr>
<tr>
<td><strong>3. Core Services (Shared)</strong></td>
<td>API Gateway, Token Service, Auth Master, User Master, Notification Master, Reporting Service.</td>
<td>Ch·∫°y <strong>m·ªôt c·ª•m</strong> cho to√†n h·ªá th·ªëng; ch·ªãu t·∫£i &amp; t√°ch bi·ªát tenant b·∫±ng JWT (<code>tid</code>).</td>
</tr>
<tr>
<td><strong>4. Tenant Stack (per tenant)</strong></td>
<td>School Management System (<strong>SMS</strong>), Auth Sub, User Sub, Notification Sub.</td>
<td>M·ªói tenant c√≥ <strong>m·ªôt</strong> stack; Sub services l√† <strong>read-replica</strong> ƒë·ªìng b·ªô qua Pub/Sub.</td>
</tr>
<tr>
<td><strong>5. Infrastructure &amp; Data Plane</strong></td>
<td>Redis (revoked token cache), Pub/Sub bus, Data Warehouse, Monitoring &amp; Logging stack.</td>
<td>H·ªó tr·ª£ b·∫£o m·∫≠t (JWKS cache, key rotation), observability, ELT b√°o c√°o.</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>Ph√¢n t·∫ßng r√µ r√†ng</strong> gi√∫p:<br/>
‚Ä¢ <strong>Isolate</strong> tenant-level logic (stack 4) kh·ªèi v√πng shared (stack 3).<br/>
‚Ä¢ <strong>Gi·∫£m coupling</strong> ‚Äì Token Service &amp; Gateway x·ª≠ l√Ω x√°c th·ª±c t·∫≠p trung.<br/>
‚Ä¢ <strong>M·ªü r·ªông</strong> ‚Äì th√™m tenant = tri·ªÉn khai m·ªôt SMS + ba Sub services, kh√¥ng ·∫£nh h∆∞·ªüng Core.</p>
</blockquote>
<hr/>
<h2 id="3-authentication-flow">3. Authentication Flow<a class="headerlink" href="#3-authentication-flow" title="Permanent link">¬∂</a></h2>
<h3 id="31-cac-thanh-phan-tham-gia">3.1 C√°c th√†nh ph·∫ßn tham gia<a class="headerlink" href="#31-cac-thanh-phan-tham-gia" title="Permanent link">¬∂</a></h3>
<table>
<thead>
<tr>
<th>Actor</th>
<th>Vai tr√≤ ch√≠nh</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Frontend / Mobile</strong></td>
<td>G·ª≠i y√™u c·∫ßu ƒëƒÉng nh·∫≠p, l∆∞u JWT, g·ªçi API Gateway.</td>
</tr>
<tr>
<td><strong>API Gateway</strong></td>
<td>C·ª≠a tr∆∞·ªõc duy nh·∫•t; x√°c th·ª±c JWT offline b·∫±ng JWKS, ki·ªÉm tra <code>revoked_tokens</code> trong Redis, u·ª∑ quy·ªÅn RBAC.</td>
</tr>
<tr>
<td><strong>Auth Master</strong></td>
<td>X√°c th·ª±c Google OAuth2, √°nh x·∫° tenant, g·ªçi Token Service.</td>
</tr>
<tr>
<td><strong>Auth Sub (per tenant)</strong></td>
<td>X√°c th·ª±c Local/OTP, ƒë·ªìng b·ªô user v·ªõi Master, g·ªçi Token Service.</td>
</tr>
<tr>
<td><strong>Token Service</strong></td>
<td>Ph√°t h√†nh / l√†m m·ªõi / thu h·ªìi JWT, ƒë·ªìng b·ªô cache thu h·ªìi sang Redis, xu·∫•t JWKS.</td>
</tr>
<tr>
<td><strong>Redis cache</strong></td>
<td>Cache <code>revoked_tokens</code> (TTL 15‚Ä≤) cho Gateway.</td>
</tr>
</tbody>
</table>
<h3 id="32-trinh-tu-ang-nhap-goi-api">3.2 Tr√¨nh t·ª± ƒëƒÉng nh·∫≠p &amp; g·ªçi API<a class="headerlink" href="#32-trinh-tu-ang-nhap-goi-api" title="Permanent link">¬∂</a></h3>
<pre class="mermaid"><code>sequenceDiagram
    participant FE as Frontend
    participant APIGW as API Gateway
    participant AuthM as Auth Master
    participant AuthSub as Auth Sub
    participant TokenSvc as Token Service
    participant Redis as Redis Cache

    FE-&gt;&gt;APIGW: POST /login (Google ho·∫∑c Local/OTP)

    alt Google OAuth2
        APIGW-&gt;&gt;AuthM: /login/google
        AuthM-&gt;&gt;Google OAuth2: OAuth dance
        Google OAuth2--&gt;&gt;AuthM: id_token
    else Local / OTP
        APIGW-&gt;&gt;AuthSub: /login/local|otp
        AuthSub-&gt;&gt;AuthSub: verify pwd / OTP
    end

    par L·∫•y RBAC
        AuthM-&gt;&gt;UserSub: GET /rbac (roles, perms)
        AuthSub-&gt;&gt;UserSub: GET /rbac
    end

    AuthM-&gt;&gt;TokenSvc: POST /token/issue
    AuthSub-&gt;&gt;TokenSvc: POST /token/issue
    TokenSvc--&gt;&gt;AuthM: access + refresh JWT
    TokenSvc--&gt;&gt;AuthSub: access + refresh JWT
    AuthM--&gt;&gt;APIGW: 200 JWT
    AuthSub--&gt;&gt;APIGW: 200 JWT
    APIGW--&gt;&gt;FE: 200 JWT

    opt Subsequent request
        FE-&gt;&gt;APIGW: GET /api/*
        APIGW-&gt;&gt;APIGW: verify RS256 via JWKS
        APIGW-&gt;&gt;Redis: jti revoked?
        alt OK
            APIGW-&gt;&gt;Backend: forward
        else Revoked / edge
            APIGW-&gt;&gt;TokenSvc: POST /token/introspect
            TokenSvc--&gt;&gt;APIGW: status
        end
    end
</code></pre>
<p><em>Ch√∫ th√≠ch s∆° ƒë·ªì</em></p>
<ul>
<li><strong>JWKS</strong> l√† c∆° ch·∫ø x√°c th·ª±c <strong>m·∫∑c ƒë·ªãnh</strong>; <code>introspect</code> ch·ªâ ƒë∆∞·ª£c g·ªçi khi Gateway c·∫ßn kh·∫≥ng ƒë·ªãnh token ch∆∞a b·ªã thu h·ªìi ho·∫∑c g·∫ßn h·∫øt h·∫°n.</li>
<li><strong>Redis</strong> ƒë√≥ng vai tr√≤ cache danh s√°ch token b·ªã thu h·ªìi; Token Service ƒë·∫©y c·∫≠p nh·∫≠t ngay khi thu h·ªìi (<code>POST /token/revoke</code>).</li>
<li>D·ªØ li·ªáu RBAC l·∫•y t·ª´ <strong>User Sub</strong> ƒë·ªÉ nh√∫ng v√†o JWT; gi√∫p Gateway authorize m√† kh√¥ng ph·∫£i g·ªçi l·∫°i database.</li>
</ul>
<h3 id="33-vong-oi-jwt">3.3 V√≤ng ƒë·ªùi JWT<a class="headerlink" href="#33-vong-oi-jwt" title="Permanent link">¬∂</a></h3>
<table>
<thead>
<tr>
<th>Giai ƒëo·∫°n</th>
<th>M√¥ t·∫£</th>
<th>TTL / L∆∞u tr·ªØ</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Issue</strong></td>
<td>Auth Master/Sub g·ªçi <code>POST /token/issue</code> ‚Üí nh·∫≠n <code>access</code> (15 ‚Ä≤) &amp; <code>refresh</code> (14 ng√†y).</td>
<td>DB (<code>auth_sessions</code>)</td>
</tr>
<tr>
<td><strong>Refresh</strong></td>
<td>Client g·ª≠i <code>refresh</code> token t·ªõi <code>POST /token/refresh</code> ‚Üí c·∫•p <code>access</code> m·ªõi, gia h·∫°n phi√™n.</td>
<td>‚Äî</td>
</tr>
<tr>
<td><strong>Revoke</strong></td>
<td>Logout / admin g·ªçi <code>POST /token/revoke</code> v·ªõi <code>jti</code> ho·∫∑c <code>sid</code>.</td>
<td>DB + Redis</td>
</tr>
<tr>
<td><strong>Introspect</strong></td>
<td>Gateway/Service g·ªçi <code>POST /token/introspect</code> n·∫øu c·∫ßn x√°c minh s√¢u.</td>
<td>Tr·∫£ <code>active: true/false</code></td>
</tr>
</tbody>
</table>
<h3 id="34-cau-truc-jwt-rs256">3.4 C·∫•u tr√∫c JWT (RS256)<a class="headerlink" href="#34-cau-truc-jwt-rs256" title="Permanent link">¬∂</a></h3>
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a href="#__codelineno-0-1" id="__codelineno-0-1" name="__codelineno-0-1"></a>sub   : user_id_global
</span><span id="__span-0-2"><a href="#__codelineno-0-2" id="__codelineno-0-2" name="__codelineno-0-2"></a>tid   : tenant_id
</span><span id="__span-0-3"><a href="#__codelineno-0-3" id="__codelineno-0-3" name="__codelineno-0-3"></a>roles : ["teacher"]
</span><span id="__span-0-4"><a href="#__codelineno-0-4" id="__codelineno-0-4" name="__codelineno-0-4"></a>perms : ["grade.read", "grade.write"]
</span><span id="__span-0-5"><a href="#__codelineno-0-5" id="__codelineno-0-5" name="__codelineno-0-5"></a>auth_provider : "google" | "local" | "otp"
</span><span id="__span-0-6"><a href="#__codelineno-0-6" id="__codelineno-0-6" name="__codelineno-0-6"></a>jti   : e4c7...  (UUID v4)
</span><span id="__span-0-7"><a href="#__codelineno-0-7" id="__codelineno-0-7" name="__codelineno-0-7"></a>sid   : 9ab0...  (session id)
</span><span id="__span-0-8"><a href="#__codelineno-0-8" id="__codelineno-0-8" name="__codelineno-0-8"></a>exp   : 1717833000
</span></code></pre></div>
<h3 id="35-bien-phap-bao-mat-bo-sung">3.5 Bi·ªán ph√°p b·∫£o m·∫≠t b·ªï sung<a class="headerlink" href="#35-bien-phap-bao-mat-bo-sung" title="Permanent link">¬∂</a></h3>
<ul>
<li><strong>Rate-limit &amp; CAPTCHA</strong> cho Local/OTP; gi·ªõi h·∫°n OTP theo IP &amp; user.</li>
<li><strong>Key rotation</strong> ‚â§ 90 ng√†y; JWKS cache 10 ph√∫t t·∫°i Gateway/CDN.</li>
<li><strong>Error code</strong> tu√¢n th·ªß <code>namespace.snake_case</code> (xem ADR-011).</li>
<li><strong>mTLS</strong> cho traffic n·ªôi b·ªô gi·ªØa Gateway ‚Üî Core/Tenant services.</li>
</ul>
<blockquote>
<p>Ph·∫ßn lu·ªìng x√°c th·ª±c n√†y ƒë·∫∑t n·ªÅn t·∫£ng cho m·ªçi d·ªãch v·ª•: JWT cung c·∫•p danh t√≠nh &amp; RBAC, c√≤n Gateway b·∫£o v·ªá bi√™n, gi·ªØ latency th·∫•p nh·ªù x√°c th·ª±c offline.</p>
</blockquote>
<hr/>
<h2 id="4-token-service-jwt-lifecycle">4. Token Service &amp; JWT Lifecycle<a class="headerlink" href="#4-token-service-jwt-lifecycle" title="Permanent link">¬∂</a></h2>
<blockquote>
<p><strong>Ngu·ªìn thi·∫øt k·∫ø</strong> ‚Äì Change Request <strong>03-cr-token-service</strong>:contentReference[oaicite:0]{index=0} &amp; <a href="ADR/adr-006-auth-strategy/">ADR-006 ‚Äì Auth Strategy</a> :contentReference[oaicite:1]{index=1}  </p>
</blockquote>
<h3 id="41-vai-tro-ranh-gioi-tin-cay">4.1 Vai tr√≤ &amp; Ranh gi·ªõi tin c·∫≠y<a class="headerlink" href="#41-vai-tro-ranh-gioi-tin-cay" title="Permanent link">¬∂</a></h3>
<ul>
<li><strong>Token Service</strong> l√† micro-service <strong>duy nh·∫•t</strong> ph√°t h√†nh, l√†m m·ªõi (<em>refresh</em>), thu h·ªìi (<em>revoke</em>) v√† introspect JWT cho to√†n b·ªô platform.  </li>
<li>Gi·ªØ <strong>private RSA key</strong> (RS256); c√¥ng khai <strong>JWKS</strong> cho API Gateway x√°c th·ª±c <strong>offline</strong>.  </li>
<li>ƒê·ªìng b·ªô danh s√°ch token b·ªã thu h·ªìi t·ªõi <strong>Redis cache</strong> ‚Üí Gateway truy v·∫•n c·ª•c b·ªô, ch·ªâ g·ªçi <code>/token/introspect</code> khi cache miss ho·∫∑c token s·∫Øp h·∫øt h·∫°n.</li>
</ul>
<h3 id="42-api-endpoints">4.2 API Endpoints<a class="headerlink" href="#42-api-endpoints" title="Permanent link">¬∂</a></h3>
<table>
<thead>
<tr>
<th>Method</th>
<th>Path</th>
<th>M√¥ t·∫£</th>
<th>ƒê·ªëi t∆∞·ª£ng g·ªçi</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>POST</code></td>
<td><code>/token/issue</code></td>
<td>Ph√°t h√†nh <em>access</em> + <em>refresh</em> token</td>
<td><strong>Auth Master / Sub</strong></td>
</tr>
<tr>
<td><code>POST</code></td>
<td><code>/token/refresh</code></td>
<td>L√†m m·ªõi <em>access</em> token khi <em>refresh</em> h·ª£p l·ªá</td>
<td><strong>Client</strong></td>
</tr>
<tr>
<td><code>POST</code></td>
<td><code>/token/revoke</code></td>
<td>Thu h·ªìi token theo <code>jti</code>/<code>sid</code></td>
<td><strong>Logout / Admin</strong></td>
</tr>
<tr>
<td><code>POST</code></td>
<td><code>/token/introspect</code></td>
<td>Tr·∫£ <code>active: true/false</code> + metadata</td>
<td><strong>Gateway / Internal</strong></td>
</tr>
<tr>
<td><code>GET</code></td>
<td><code>/.well-known/jwks.json</code></td>
<td>JWKS (public keys)</td>
<td><strong>Gateway / Services / Clients</strong></td>
</tr>
</tbody>
</table>
<h3 id="43-key-management">4.3 Key Management üîë<a class="headerlink" href="#43-key-management" title="Permanent link">¬∂</a></h3>
<ul>
<li>Thu·∫≠t to√°n <strong>RS256</strong>; gi·ªØ <strong>2 key</strong> ho·∫°t ƒë·ªông song song (<code>kid=current|next</code>).  </li>
<li><strong>Lu√¢n phi√™n kh√≥a</strong> t·ªëi ƒëa <strong>90 ng√†y/l·∫ßn</strong>; tri·ªÉn khai b·∫±ng Cloud KMS + GitOps pipeline :contentReference[oaicite:2]{index=2}.  </li>
<li><strong>JWKS</strong> c√≥ <code>Cache-Control: public, max-age=600</code> ‚Äì Gateway t·∫£i l·∫°i t·ª± ƒë·ªông m·ªói 10 ph√∫t.</li>
</ul>
<h3 id="44-cau-truc-jwt-ttl">4.4 C·∫•u tr√∫c JWT &amp; TTL<a class="headerlink" href="#44-cau-truc-jwt-ttl" title="Permanent link">¬∂</a></h3>
<table>
<thead>
<tr>
<th>Claim</th>
<th>√ù nghƒ©a</th>
<th>V√≠ d·ª•</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>sub</code></td>
<td><code>user_id_global</code></td>
<td><code>"u-123"</code></td>
</tr>
<tr>
<td><code>tid</code></td>
<td><code>tenant_id</code></td>
<td><code>"tenant-abc"</code></td>
</tr>
<tr>
<td><code>roles</code>, <code>permissions</code></td>
<td>RBAC</td>
<td><code>["teacher"]</code>, <code>["grade.read"]</code></td>
</tr>
<tr>
<td><code>auth_provider</code></td>
<td><code>"google"</code> / <code>"local"</code> / <code>"otp"</code></td>
<td>‚Äî</td>
</tr>
<tr>
<td><code>jti</code></td>
<td>Token ID (UUID v4)</td>
<td><code>"e4c7..."</code></td>
</tr>
<tr>
<td><code>sid</code></td>
<td>Session ID</td>
<td><code>"9ab0..."</code></td>
</tr>
<tr>
<td><code>exp</code></td>
<td>H·∫øt h·∫°n ‚â§ 15‚Ä≤ (access)</td>
<td><code>1717833000</code></td>
</tr>
</tbody>
</table>
<p><em>Refresh token: TTL 14 ng√†y, l∆∞u b·∫£ng <code>auth_sessions</code>.</em></p>
<h3 id="45-thu-hoi-token-redis-cache">4.5 Thu h·ªìi token &amp; Redis Cache<a class="headerlink" href="#45-thu-hoi-token-redis-cache" title="Permanent link">¬∂</a></h3>
<pre class="mermaid"><code>flowchart LR
  TokenSvc -- "sync revoked (jti)" --&gt; Redis[(Redis<br/>revoked_tokens)]
  APIGW -- "check jti" --&gt; Redis
  APIGW -- "introspect (rare)" --&gt; TokenSvc
</code></pre>
<ul>
<li><strong>Redis TTL 15 ph√∫t</strong> ‚Äì ƒë·ªß nhanh ƒë·ªÉ propagation nh∆∞ng kh√¥ng qu√° t·∫£i network.</li>
<li>Gateway ch·ªâ ‚Äúr∆°i v·ªÅ‚Äù <code>/introspect</code> khi <strong>cache miss</strong> ho·∫∑c c·∫ßn ki·ªÉm tra chi ti·∫øt phi√™n (<code>sid</code>).</li>
</ul>
<h3 id="46-event-publishing">4.6 Event Publishing üì°<a class="headerlink" href="#46-event-publishing" title="Permanent link">¬∂</a></h3>
<ul>
<li>Ph√°t s·ª± ki·ªán <code>token.issued</code> &amp; <code>token.revoked</code> l√™n <strong>Pub/Sub</strong> ‚Üí <strong>Audit-Logging</strong> &amp; dashboard ‚Äútoken-per-minute‚Äù, ‚Äúrevoked-rate‚Äù.</li>
<li>S·ª± ki·ªán tu√¢n th·ªß schema <code>token.{issued|revoked}.v1</code> (tham kh·∫£o ADR-030 ‚Äì Event Schema Governance).</li>
</ul>
<h3 id="47-error-codes">4.7 Error Codes<a class="headerlink" href="#47-error-codes" title="Permanent link">¬∂</a></h3>
<ul>
<li>T·∫•t c·∫£ response l·ªói bao b·ªçc theo <code>ErrorEnvelope</code> (ADR-011).</li>
<li>Quy ∆∞·ªõc <code>namespace.snake_case</code>, v√≠ d·ª• <code>token.expired</code>, <code>session.not_found</code> ‚Äì qu·∫£n l√Ω trong <code>docs/standards/error-codes.md</code>.</li>
</ul>
<h3 id="48-kpi-monitoring">4.8 KPI &amp; Monitoring<a class="headerlink" href="#48-kpi-monitoring" title="Permanent link">¬∂</a></h3>
<table>
<thead>
<tr>
<th>KPI</th>
<th>M·ª•c ti√™u</th>
<th>Alert</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Token issue latency (p95)</strong></td>
<td>&lt; 100 ms</td>
<td>&gt; 200 ms 5‚Ä≤ li√™n t·ª•c</td>
</tr>
<tr>
<td><strong>Revoked-check hit-ratio</strong></td>
<td>&gt; 95 % (Redis)</td>
<td>&lt; 90 % 10‚Ä≤ li√™n t·ª•c</td>
</tr>
<tr>
<td><strong>Key rotation drift</strong></td>
<td>‚â§ 90 ng√†y</td>
<td>80 ng√†y ‚Üí c·∫£nh b√°o</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>T√≥m t·∫Øt</strong> ‚Äì ƒê·∫∑t Token Service l√†m ‚Äúnh√† m√°y‚Äù JWT gi√∫p ƒë·∫£m b·∫£o b·∫£o m·∫≠t, gi·∫£m ƒë·ªô tr·ªÖ v√† ƒë∆°n gi·∫£n ho√° qu·∫£n l√Ω v√≤ng ƒë·ªùi token cho to√†n h·ªá th·ªëng.</p>
</blockquote>
<hr/>
<h2 id="5-tenant-stack-school-management-system-sms">5. Tenant Stack &amp; School Management System (SMS)<a class="headerlink" href="#5-tenant-stack-school-management-system-sms" title="Permanent link">¬∂</a></h2>
<h3 id="51-khai-niem-tenant-stack">5.1 Kh√°i ni·ªám Tenant Stack<a class="headerlink" href="#51-khai-niem-tenant-stack" title="Permanent link">¬∂</a></h3>
<p>M·ªói <strong>tenant</strong> (tr∆∞·ªùng) c√≥ m·ªôt <strong>stack</strong> d·ªãch v·ª• bi·ªát l·∫≠p, tri·ªÉn khai tr√™n <strong>GCP project ri√™ng</strong> theo chi·∫øn l∆∞·ª£c <code>dx-vas-tenant-&lt;name&gt;</code> (xem ADR-015, ADR-019) .<br/>
Stack bao g·ªìm:</p>
<table>
<thead>
<tr>
<th>L·ªõp</th>
<th>Th√†nh ph·∫ßn</th>
<th>Ghi ch√∫</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Frontend</strong></td>
<td><strong>Admin / Teacher / Student / Parent Portal</strong></td>
<td>4 portal chu·∫©n ho√°, d√πng chung m√£ ngu·ªìn; tu·ª≥ bi·∫øn theme per tenant :contentReference[oaicite:0]{index=0}</td>
</tr>
<tr>
<td><strong>Backend</strong></td>
<td><strong>School Management System (SMS)</strong></td>
<td>·ª®ng d·ª•ng Docker t√≠ch h·ª£p CRM + SIS + LMS; thay th·∫ø ho√†n to√†n 3 adapter c≈©</td>
</tr>
<tr>
<td><strong>Sub Services</strong></td>
<td><code>auth-sub</code>, <code>user-sub</code>, <code>notif-sub</code></td>
<td><em>Read-replica</em> ƒë·ªìng b·ªô d·ªØ li·ªáu t·ª´ c√°c <strong>Master</strong> qua Pub/Sub; ch·ªâ ƒë·ªçc/ghi t·ªëi thi·ªÉu cho tenant :contentReference[oaicite:1]{index=1}</td>
</tr>
<tr>
<td><strong>Data &amp; Cache</strong></td>
<td><strong>MariaDB</strong> (SMS DB), Redis (local), Pub/Sub topic-per-tenant</td>
<td>DB b·∫£n ƒë·ªãa c·ªßa SMS (MariaDB Galera cluster) + cache phi√™n b·∫£n ho√° (<code>stack_version</code>, ADR-025)</td>
</tr>
</tbody>
</table>
<h3 id="52-luong-chinh">5.2 Lu·ªìng ch√≠nh<a class="headerlink" href="#52-luong-chinh" title="Permanent link">¬∂</a></h3>
<ol>
<li><strong>Portal</strong> g·ªçi <strong>API Gateway</strong> k√®m header <code>X-Tenant-ID</code>.  </li>
<li>Gateway ƒë·ªãnh tuy·∫øn <code>/sms/**</code> t·ªõi <strong>SMS</strong> c·ªßa tenant; ch√®n th√™m header <code>X-User-ID</code>, <code>X-Permissions</code> ƒë·ªÉ RBAC ho·∫°t ƒë·ªông.  </li>
<li><strong>SMS</strong> ph·ª•c v·ª• nghi·ªáp v·ª• tr∆∞·ªùng (ƒëi·ªÉm danh, h·ªçc ph√≠, LMS, v.v.).  </li>
<li><strong>User-sub</strong> &amp; <strong>Notif-sub</strong> nh·∫≠n s·ª± ki·ªán t·ª´ <strong>User-master</strong> / <strong>Notif-master</strong> qua Pub/Sub ‚Üí c·∫≠p nh·∫≠t DB c·ª•c b·ªô.  </li>
<li><strong>ELT pipeline</strong> tr√≠ch xu·∫•t d·ªØ li·ªáu SMS ‚Üí <strong>Data Warehouse</strong>; <strong>Reporting Service</strong> truy v·∫•n DW t·∫°o dashboard ƒëa-tenant .</li>
</ol>
<h3 id="53-loi-ich-kien-truc">5.3 L·ª£i √≠ch ki·∫øn tr√∫c<a class="headerlink" href="#53-loi-ich-kien-truc" title="Permanent link">¬∂</a></h3>
<ul>
<li><strong>ƒê∆°n gi·∫£n ho√° v·∫≠n h√†nh</strong> ‚Äì Lo·∫°i b·ªè ba adapter, gi·∫£m s·ªë container per tenant ~ 60 %.  </li>
<li><strong>On-boarding nhanh</strong> ‚Äì Th√™m tenant = deploy m·ªôt container SMS + 3 sub services (Terraform module ‚Äútenant-stack‚Äù).  </li>
<li><strong>Tr·∫£i nghi·ªám nh·∫•t qu√°n</strong> ‚Äì 4 portal chia s·∫ª UI/UX v√† SSO, gi·∫£m chi ph√≠ h·ªó tr·ª£ ng∆∞·ªùi d√πng :contentReference[oaicite:3]{index=3}.  </li>
<li><strong>T√°ch billing &amp; b·∫£o m·∫≠t</strong> ‚Äì Project ri√™ng, log/alert d√°n nh√£n <code>tenant_id</code> (ADR-022) :contentReference[oaicite:4]{index=4}.</li>
</ul>
<h3 id="54-chuan-trien-khai-versioning">5.4 Chu·∫©n tri·ªÉn khai &amp; versioning<a class="headerlink" href="#54-chuan-trien-khai-versioning" title="Permanent link">¬∂</a></h3>
<ul>
<li>Docker image SMS g·∫Øn th·∫ª <code>vX.Y.Z</code>; th√¥ng tin <code>stack_version</code> l∆∞u trong secret m·ªói tenant (ADR-025).  </li>
<li>CI/CD h·ªó tr·ª£ rollout so le; Superadmin Webapp qu·∫£n l√Ω mapping tenant ‚Üî version.  </li>
<li>Pipeline <strong>terraform + github actions</strong> t·ª± ƒë·ªông t·∫°o project, DNS, secrets, certs theo template (ADR-015).  </li>
</ul>
<blockquote>
<p><strong>TL;DR</strong> ‚Äì Tenant Stack m·ªõi g√≥i g·ªçn nghi·ªáp v·ª• tr∆∞·ªùng trong <strong>m·ªôt</strong> SMS, li√™n k·∫øt an to√†n v√†o khung x√°c th·ª±c &amp; quan s√°t chung, gi√∫p dx-vas ‚Äúon-board m·ªôt tr∆∞·ªùng m·ªõi trong v√†i gi·ªù thay v√¨ v√†i ng√†y‚Äù.</p>
</blockquote>
<hr/>
<h2 id="6-core-business-services">6. Core &amp; Business Services<a class="headerlink" href="#6-core-business-services" title="Permanent link">¬∂</a></h2>
<blockquote>
<p><strong>M·ª•c ti√™u</strong> ‚Äì Li·ªát k√™ c√°c d·ªãch v·ª• ch·∫°y <strong>d√πng chung</strong> (Core) v√† <strong>d·ªãch v·ª• nghi·ªáp v·ª•</strong> (Business), k√®m ƒë∆∞·ªùng d·∫´n t√†i li·ªáu k·ªπ thu·∫≠t (ADR / SDD) ƒë·ªÉ tra c·ª©u chi ti·∫øt.</p>
</blockquote>
<h3 id="61-core-services-shared">6.1 Core Services (Shared)<a class="headerlink" href="#61-core-services-shared" title="Permanent link">¬∂</a></h3>
<table>
<thead>
<tr>
<th>#</th>
<th>Service</th>
<th>M·ª•c ƒë√≠ch ch√≠nh</th>
<th>ADR / SDD</th>
<th>Ghi ch√∫</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td><strong>API Gateway</strong></td>
<td>C·ªïng v√†o duy nh·∫•t, route &amp; rate-limit, x√°c th·ª±c JWT, g·∫Øn RBAC.</td>
<td>ADR-009 ‚Äì API Governance</td>
<td>Envoy + Lua filter, mTLS n·ªôi b·ªô</td>
</tr>
<tr>
<td>2</td>
<td><strong>Token Service</strong></td>
<td>Ph√°t h√†nh / refresh / revoke JWT, JWKS.</td>
<td>ADR-006 ‚Äì Auth Strategy; CR-03</td>
<td>RS256, Redis revoked cache</td>
</tr>
<tr>
<td>3</td>
<td><strong>Auth Master</strong></td>
<td>ƒêƒÉng nh·∫≠p Google OAuth2, √°nh x·∫° tenant.</td>
<td>ADR-006</td>
<td>Stateless; l∆∞u session b√™n TokenSvc</td>
</tr>
<tr>
<td>4</td>
<td><strong>User Master</strong></td>
<td>Qu·∫£n l√Ω profile to√†n c·ª•c, RBAC master.</td>
<td><em>SDD-User-Master</em> (WIP)</td>
<td>Pub/Sub ph√°t s·ª± ki·ªán user.*</td>
</tr>
<tr>
<td>5</td>
<td><strong>Notification Master</strong></td>
<td>Orchestrate g·ª≠i email/SMS, qu·∫£n l√Ω template.</td>
<td>ADR-008 ‚Äì Audit Logging; ADR-028 ‚Äì Reporting</td>
<td>Fan-out t·ªõi Notif-Sub</td>
</tr>
<tr>
<td>6</td>
<td><strong>Reporting Service</strong></td>
<td>Truy v·∫•n Data Warehouse, sinh dashboard &amp; export.</td>
<td>ADR-028 ‚Äì Reporting Architecture</td>
<td>Multi-tenant; BigQuery</td>
</tr>
<tr>
<td>7</td>
<td><strong>Audit-Logging Service</strong></td>
<td>Thu th·∫≠p &amp; k√Ω log truy v·∫øt.</td>
<td>ADR-008</td>
<td>B·∫Øt s·ª± ki·ªán token.<em>, user.</em></td>
</tr>
<tr>
<td>8</td>
<td><strong>Cost Observability</strong></td>
<td>Theo d√µi chi ph√≠ cloud / tenant.</td>
<td>ADR-020 ‚Äì Cost Observability</td>
<td>Grafana + Cloud Billing API</td>
</tr>
<tr>
<td>9</td>
<td><strong>External Observability</strong></td>
<td>Gi√°m s√°t uptime API b√™n ngo√†i.</td>
<td>ADR-021 ‚Äì External Observability</td>
<td>Synthetic probe, SLA report</td>
</tr>
<tr>
<td>10</td>
<td><strong>Pub/Sub Bus</strong></td>
<td>K√™nh s·ª± ki·ªán b·∫•t ƒë·ªìng b·ªô.</td>
<td>ADR-030 ‚Äì Event Schema Gov.</td>
<td>topic=‚Äútenant.*‚Äù, schema registry</td>
</tr>
<tr>
<td>11</td>
<td><strong>Redis Cluster</strong></td>
<td>Revoked-token cache + transient data.</td>
<td>ADR-022 ‚Äì SLO &amp; Monitoring</td>
<td>3-node, cross-zone</td>
</tr>
</tbody>
</table>
<h3 id="62-business-services-per-tenant">6.2 Business Services (per tenant)<a class="headerlink" href="#62-business-services-per-tenant" title="Permanent link">¬∂</a></h3>
<table>
<thead>
<tr>
<th>#</th>
<th>Service</th>
<th>M·ª•c ƒë√≠ch</th>
<th>ADR / SDD</th>
<th>Ghi ch√∫</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td><strong>School Management System (SMS)</strong></td>
<td>CRM + SIS + LMS t√≠ch h·ª£p.</td>
<td><em>SDD-SMS</em> (WIP)</td>
<td>MariaDB; expose <code>/sms/**</code></td>
</tr>
<tr>
<td>2</td>
<td><strong>Auth Sub</strong></td>
<td>ƒêƒÉng nh·∫≠p Local/OTP, sync user.</td>
<td>ADR-006</td>
<td>B·∫Øt bu·ªôc n·∫øu d√πng Local/OTP</td>
</tr>
<tr>
<td>3</td>
<td><strong>User Sub</strong></td>
<td>Read-replica profile + RBAC theo tenant.</td>
<td><em>SDD-User-Sub</em> (WIP)</td>
<td>ƒê·ªìng b·ªô qua Pub/Sub</td>
</tr>
<tr>
<td>4</td>
<td><strong>Notification Sub</strong></td>
<td>ƒê·∫©y th√¥ng b√°o realtime n·ªôi b·ªô tenant.</td>
<td>ADR-008</td>
<td>Nh·∫≠n event t·ª´ Notif Master</td>
</tr>
<tr>
<td>5</td>
<td><strong>Local Redis</strong></td>
<td>Cache session / OTP temp.</td>
<td>(inherit core pattern)</td>
<td>Ch·ªâ trong tenant VPC</td>
</tr>
</tbody>
</table>
<p><em>C√°c </em><em>adapter c≈©</em><em> <code>crm-adapter</code>, <code>sis-adapter</code>, <code>lms-adapter</code> </em><em>ƒë√£ ng∆∞ng</em><em> ‚Äì thay th·∫ø ho√†n to√†n b·ªüi SMS.</em></p>
<h3 id="63-cross-cutting-infrastructure">6.3 Cross-cutting &amp; Infrastructure<a class="headerlink" href="#63-cross-cutting-infrastructure" title="Permanent link">¬∂</a></h3>
<table>
<thead>
<tr>
<th>Th√†nh ph·∫ßn</th>
<th>Vai tr√≤</th>
<th>Li√™n quan</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>GitOps / ArgoCD</strong></td>
<td>Deploy Core + Tenant Stack, m√¥i tr∆∞·ªùng Stage/Prod.</td>
<td>ADR-001 ‚Äì CI/CD</td>
</tr>
<tr>
<td><strong>Terraform Modules</strong></td>
<td>Provision VPC, CloudSQL (MariaDB), Secrets, DNS.</td>
<td>ADR-015 ‚Äì Deployment Strategy</td>
</tr>
<tr>
<td><strong>Data Warehouse (BigQuery)</strong></td>
<td>L∆∞u tr·ªØ ELT t·ª´ SMS, log ph√¢n t√°ch theo <code>tenant_id</code>.</td>
<td>ADR-028</td>
</tr>
<tr>
<td><strong>Grafana + Prometheus</strong></td>
<td>Monitor CPU, latency, SLO dashboard.</td>
<td>ADR-022</td>
</tr>
<tr>
<td><strong>OpenTelemetry Collector</strong></td>
<td>Trace &amp; log routing ‚Üí GCP Cloud Logging.</td>
<td>ADR-021</td>
</tr>
</tbody>
</table>
<h3 id="64-uu-tien-phat-trien-roadmap">6.4 ∆Øu ti√™n ph√°t tri·ªÉn (Roadmap)<a class="headerlink" href="#64-uu-tien-phat-trien-roadmap" title="Permanent link">¬∂</a></h3>
<ol>
<li><strong>User Service Master ‚Äì SDD ‚ÄúLegendary++‚Äù</strong> (ƒëang vi·∫øt) ‚Üí unlock RBAC advance.  </li>
<li><strong>SMS OpenAPI</strong> ‚Üí chu·∫©n ho√° contract, b·∫≠t code-gen client cho portal.  </li>
<li><strong>Audit-Logging v2</strong> ‚Üí blockchain timestamp &amp; zero-trust export.  </li>
<li><strong>Cost Observability automation</strong> ‚Üí chargeback d√≤ng ti·ªÅn per tenant.  </li>
<li><strong>External Observability SLA dashboard</strong> ‚Üí public status.truongvietanh.edu.vn.</li>
</ol>
<blockquote>
<p><strong>Ghi nh·ªõ:</strong> M·ªçi d·ªãch v·ª• m·ªõi <strong>ph·∫£i</strong> tu√¢n th·ªß b·ªô <strong>5‚òÖ standards</strong> v√† ƒë∆∞·ª£c ghi l·∫°i d∆∞·ªõi d·∫°ng <strong>ADR + SDD</strong> tr∆∞·ªõc khi tri·ªÉn khai.</p>
</blockquote>
<hr/>
<h2 id="7-observability-security">7. Observability &amp; Security<a class="headerlink" href="#7-observability-security" title="Permanent link">¬∂</a></h2>
<blockquote>
<p><strong>M·ª•c ti√™u</strong> ‚Äì ƒê·∫£m b·∫£o <strong>t√≠nh minh b·∫°ch (observability)</strong> cho v·∫≠n h√†nh v√† <strong>t√≠nh an to√†n (security)</strong> cho d·ªØ li·ªáu/ngu·ªìn l·ª±c c·ªßa to√†n h·ªá th·ªëng DX-VAS. C√°c nguy√™n t·∫Øc b√™n d∆∞·ªõi l·∫•y cƒÉn c·ª© t·ª´:<br/>
‚Ä¢ <code>ADR-004 ‚Äì Security</code> ¬∑ <code>ADR-022 ‚Äì SLO &amp; Monitoring</code> ¬∑ <code>ADR-020 ‚Äì Cost Observability</code> ¬∑ <code>ADR-021 ‚Äì External Observability</code> ¬∑ <code>ADR-011 ‚Äì API Error Format</code> ¬∑ <code>ADR-003 ‚Äì Secrets</code> </p>
</blockquote>
<h3 id="71-observability">7.1 Observability üîç<a class="headerlink" href="#71-observability" title="Permanent link">¬∂</a></h3>
<table>
<thead>
<tr>
<th>Kh√≠a c·∫°nh</th>
<th>Th·ª±c hi·ªán</th>
<th>C√¥ng c·ª• / ADR</th>
<th>C·∫£nh b√°o &amp; Dashboard</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Logging</strong></td>
<td>To√†n b·ªô service log theo chu·∫©n JSON (<code>trace_id</code>, <code>tenant_id</code>, <code>level</code>, <code>error.code</code>).</td>
<td>ADR-011</td>
<td>Cloud Logging + Log-based Metrics; alert <code>error.rate &gt; 5 %</code>/5‚Ä≤</td>
</tr>
<tr>
<td><strong>Metrics</strong></td>
<td>Prometheus scrape Gateway, Core &amp; Tenant; export qua OTLP.</td>
<td>ADR-022</td>
<td>Grafana dashboard CPU, latency, p95</td>
</tr>
<tr>
<td><strong>Tracing</strong></td>
<td>OpenTelemetry inject v√†o Gateway ‚Üí trace xuy√™n su·ªët tenant.</td>
<td>ADR-022</td>
<td>Jaeger UI; c·∫£nh b√°o span &gt; 3 s</td>
</tr>
<tr>
<td><strong>SLO / SLA</strong></td>
<td>Each core API khai b√°o target (e.g., <code>availability 99.9 %</code>).</td>
<td>ADR-022</td>
<td>Alert khi <code>error_budget</code> c√≤n &lt; 5 %</td>
</tr>
<tr>
<td><strong>Cost</strong></td>
<td>Collect GCP Billing + resource tag <code>tenant_id</code>.</td>
<td>ADR-020</td>
<td>‚ÄúCost per tenant‚Äù / ng√†y, c·∫£nh b√°o tƒÉng &gt; 20 %</td>
</tr>
<tr>
<td><strong>External Uptime</strong></td>
<td>Synthetic probe HTTPS 1‚Ä≤/tenant.</td>
<td>ADR-021</td>
<td>Public status page; SMS alert downtime &gt; 1‚Ä≤</td>
</tr>
</tbody>
</table>
<h4 id="711-revoked-token-hit-ratio">7.1.1 Revoked-Token Hit Ratio<a class="headerlink" href="#711-revoked-token-hit-ratio" title="Permanent link">¬∂</a></h4>
<ul>
<li><strong>Metric</strong>: <code>revoked_token_cache_hit_ratio</code> (Gateway).  </li>
<li><strong>M·ª•c ti√™u</strong>: &gt; 95 %. Alert n·∫øu &lt; 90 % li√™n t·ª•c 10 ph√∫t ‚Üí ƒëi·ªÅu tra Redis / sync Token Service.</li>
</ul>
<h3 id="72-security">7.2 Security üõ°Ô∏è<a class="headerlink" href="#72-security" title="Permanent link">¬∂</a></h3>
<table>
<thead>
<tr>
<th>Th√†nh ph·∫ßn</th>
<th>Bi·ªán ph√°p</th>
<th>ADR / T√†i li·ªáu</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>JWT</strong></td>
<td>RS256, <code>kid</code> double keys, rotation ‚â§ 90 ng√†y; JWKS cache 10‚Ä≤.</td>
<td>ADR-006</td>
</tr>
<tr>
<td><strong>API Gateway</strong></td>
<td>mTLS n·ªôi b·ªô, WAF rule OWASP top-10, strict CORS.</td>
<td>ADR-004</td>
</tr>
<tr>
<td><strong>Secrets</strong></td>
<td>GCP Secret Manager, versioning &amp; rotation CI.</td>
<td>ADR-003</td>
</tr>
<tr>
<td><strong>RBAC</strong></td>
<td>Claims <code>roles</code>, <code>permissions</code> trong JWT; Gateway Enforcer plugin.</td>
<td>ADR-007</td>
</tr>
<tr>
<td><strong>Data-at-Rest</strong></td>
<td>Cloud KMS key-encrypted (MariaDB, Redis, BigQuery).</td>
<td>ADR-004</td>
</tr>
<tr>
<td><strong>Network</strong></td>
<td>VPC-SC, egress whitelisting, Cloud Armor rate-limit.</td>
<td>ADR-004</td>
</tr>
<tr>
<td><strong>Audit Log</strong></td>
<td>Token, user, admin action ‚Üí Audit-Logging Service (immutable).</td>
<td>ADR-008</td>
</tr>
<tr>
<td><strong>Error Handling</strong></td>
<td><code>ErrorEnvelope</code> + <code>namespace.snake_case</code>; kh√¥ng l·ªô PII.</td>
<td>ADR-011</td>
</tr>
</tbody>
</table>
<h4 id="721-key-rotation-jwks">7.2.1 Key Rotation &amp; JWKS<a class="headerlink" href="#721-key-rotation-jwks" title="Permanent link">¬∂</a></h4>
<ul>
<li><strong>Rotation job</strong>: Cloud Build pipeline t·∫°o key m·ªõi, g·∫Øn <code>kid=next</code>, deploy Token Service ‚Üí sau 24 h xo√° key c≈©.  </li>
<li><strong>Fallback</strong>: N·∫øu JWKS fetch l·ªói &gt; 3 l·∫ßn, Gateway c·ª©ng ch·∫∑n traffic (fail-closed).</li>
</ul>
<h4 id="722-pen-test-compliance">7.2.2 Pen-test &amp; Compliance<a class="headerlink" href="#722-pen-test-compliance" title="Permanent link">¬∂</a></h4>
<ul>
<li><strong>Quarterly</strong> penetration test + SAST/DAST; k·∫øt qu·∫£ l∆∞u <strong>requests/04-cr-tenant-system.md</strong> ph·ª• l·ª•c b·∫£o m·∫≠t.  </li>
<li>Tu√¢n th·ªß <strong>GDPR</strong> cho d·ªØ li·ªáu h·ªçc sinh &amp; ph·ª• huynh; d·ªØ li·ªáu PII ƒë∆∞·ª£c ·∫©n danh theo <code>ADR-024</code>.</li>
</ul>
<h3 id="73-alert-routing-escalation">7.3 Alert Routing &amp; Escalation<a class="headerlink" href="#73-alert-routing-escalation" title="Permanent link">¬∂</a></h3>
<table>
<thead>
<tr>
<th>Severity</th>
<th>Trigger v√≠ d·ª•</th>
<th>Th·ªùi gian ph·∫£n h·ªìi</th>
<th>K√™nh</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>P1</strong></td>
<td>API Gateway 5xx surge &gt; 10 % 2‚Ä≤</td>
<td>5‚Ä≤</td>
<td>PagerDuty ‚Üí Phone</td>
</tr>
<tr>
<td><strong>P2</strong></td>
<td>SLO breach d·ª± b√°o 4 h</td>
<td>30‚Ä≤</td>
<td>Slack #sre-alerts</td>
</tr>
<tr>
<td><strong>P3</strong></td>
<td>Cost ‚Üë 20 % ng√†y</td>
<td>8 h</td>
<td>Email FinOps</td>
</tr>
<tr>
<td><strong>P4</strong></td>
<td>Log anomaly non-critical</td>
<td>24 h</td>
<td>Jira ticket</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>Nguy√™n t·∫Øc v√†ng</strong>: ‚ÄúB·∫°n kh√¥ng th·ªÉ b·∫£o v·ªá ƒëi·ªÅu b·∫°n kh√¥ng quan s√°t ƒë∆∞·ª£c.‚Äù ‚Äì Observability &amp; Security ph·∫£i song h√†nh ƒë·ªÉ DX-VAS v·∫≠n h√†nh tin c·∫≠y, tu√¢n th·ªß, v√† t·ªëi ∆∞u chi ph√≠.</p>
</blockquote>
<hr/>
<h2 id="8-cicd-deployment">8. CI/CD &amp; Deployment<a class="headerlink" href="#8-cicd-deployment" title="Permanent link">¬∂</a></h2>
<blockquote>
<p>C∆° ch·∫ø <strong>CI/CD</strong> c·ªßa DX-VAS √°p d·ª•ng tri·ªát ƒë·ªÉ tri·∫øt l√Ω <strong>‚ÄúEverything-as-Code‚Äù</strong> v√† <strong>GitOps</strong>, b·∫£o ƒë·∫£m tri·ªÉn khai <strong>Zero-Downtime</strong> theo <code>ADR-014</code>, ·ªßy quy·ªÅn ph√°t h√†nh r√µ r√†ng theo <code>ADR-018</code>, v√† h·∫° t·∫ßng b·∫•t bi·∫øn theo <code>ADR-002</code> &amp; <code>ADR-015</code>.</p>
</blockquote>
<h3 id="81-nhanh-ma-chinh-sach-pr">8.1 Nh√°nh m√£ &amp; Ch√≠nh s√°ch PR<a class="headerlink" href="#81-nhanh-ma-chinh-sach-pr" title="Permanent link">¬∂</a></h3>
<table>
<thead>
<tr>
<th>Nh√°nh</th>
<th>M·ª•c ƒë√≠ch</th>
<th>B·∫£o v·ªá</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>main</code></td>
<td>M√£ ƒë√£ QA, s·∫µn s√†ng production</td>
<td>PR b·∫Øt bu·ªôc 2 reviewer + pass check</td>
</tr>
<tr>
<td><code>develop</code></td>
<td>H·ªôi t·ª• feature; deploy <strong>Staging</strong> t·ª± ƒë·ªông</td>
<td>PR 1 reviewer</td>
</tr>
<tr>
<td><code>feature/*</code></td>
<td>T√≠nh nƒÉng / bugfix</td>
<td>Run CI unit-test</td>
</tr>
</tbody>
</table>
<h3 id="82-pipeline-ci-github-actions">8.2 Pipeline CI (GitHub Actions)<a class="headerlink" href="#82-pipeline-ci-github-actions" title="Permanent link">¬∂</a></h3>
<ol>
<li><strong>Checkout + Cache</strong><br/>
<code>actions/checkout@v4</code> ‚Üí thi·∫øt l·∫≠p cache pnpm / poetry.</li>
<li><strong>Static Analysis &amp; SCA</strong> </li>
<li><strong>SAST</strong> (SonarQube) ‚Äì fail n·∫øu <em>critical</em>.  </li>
<li><strong>Dependency CVE</strong> (Dependabot).  </li>
<li><strong>Unit &amp; Contract Test</strong> </li>
<li>Python/PyTest + Coverage ‚â• 85 %.  </li>
<li><strong>Contract-Testing</strong> theo <code>ADR-010</code> (PactFlow).  </li>
<li><strong>Build &amp; SBOM</strong> </li>
<li>Docker multi-arch (<code>linux/amd64, arm64</code>).  </li>
<li>T·∫°o <strong>SBOM CycloneDX</strong>; push Artifact Registry.  </li>
<li><strong>Image Scan</strong> (GCP Container Analysis) ‚Äì block CVE ‚ÄúHigh‚Äù.</li>
<li><strong>Publish</strong> </li>
<li>Tag <code>main</code> ‚áí <code>vX.Y.Z</code> (semantic-release).  </li>
<li>Upload Helm chart ‚Üí <strong>Helm Repo</strong>.</li>
</ol>
<h3 id="83-pipeline-cd-argo-cd-terraform-cloud">8.3 Pipeline CD (Argo CD + Terraform Cloud)<a class="headerlink" href="#83-pipeline-cd-argo-cd-terraform-cloud" title="Permanent link">¬∂</a></h3>
<table>
<thead>
<tr>
<th>Pha</th>
<th>C√¥ng c·ª•</th>
<th>ƒêi·ªÅu ki·ªán / Ph√™ duy·ªát</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Infra-Provision</strong></td>
<td>Terraform Cloud</td>
<td>PR tr√™n <em>infra repo</em> ‚Üí auto-plan, <strong>Manual Approve</strong></td>
</tr>
<tr>
<td><strong>Staging Deploy</strong></td>
<td>Argo CD (sync-wave 0)</td>
<td>Auto n·∫øu container tag <code>v*</code> push l√™n <code>develop</code></td>
</tr>
<tr>
<td><strong>Integration Test</strong></td>
<td>GitHub Action + Postman</td>
<td>Pass 95 % ‚Üí ghi ch√∫ v√†o PR</td>
</tr>
<tr>
<td><strong>Release Approval</strong></td>
<td>Argo CD wave ‚Äúprod-canary‚Äù</td>
<td>Y√™u c·∫ßu <strong>Product Owner + SRE</strong> (theo <code>ADR-018</code>)</td>
</tr>
<tr>
<td><strong>Canary 10 %</strong></td>
<td>Argo Rollouts</td>
<td>15 min metric check (latency / error rate)</td>
</tr>
<tr>
<td><strong>Full Ramp-Up</strong></td>
<td>Argo Rollouts</td>
<td>Auto n·∫øu canary stable</td>
</tr>
<tr>
<td><strong>Rollback</strong></td>
<td>Argo Rollouts <code>rollback</code></td>
<td>&lt; 2 min; traffic switch 100 ‚Üí previous</td>
</tr>
</tbody>
</table>
<h3 id="84-zero-downtime-chien-luoc-trien-khai">8.4 Zero-Downtime &amp; Chi·∫øn l∆∞·ª£c Tri·ªÉn khai<a class="headerlink" href="#84-zero-downtime-chien-luoc-trien-khai" title="Permanent link">¬∂</a></h3>
<ul>
<li><strong>Canary Rollout</strong> (default) ‚Äì 10 ‚Üí 25 ‚Üí 50 ‚Üí 100 %.  </li>
<li><strong>Blue-Green</strong> ‚Äì d√πng cho migration DB l·ªõn (flag <code>strategy=bluegreen</code>).  </li>
<li><strong>Schema Migration</strong> ‚Äì <strong>GitOps-DB</strong> ch·∫°y <code>flyway</code> job ‚Üí version-controlled (ADR-023).  </li>
<li><strong>Auto-Scaling</strong> ‚Äì HPA theo p95 latency &amp; CPU (ADR-016).  </li>
<li><strong>Env Deploy Boundary</strong> ‚Äì Staging v√† Prod t√°ch VPC, project (GCP) (ADR-017).</li>
</ul>
<h3 id="85-tenant-on-boarding-pipeline">8.5 Tenant On-Boarding Pipeline<a class="headerlink" href="#85-tenant-on-boarding-pipeline" title="Permanent link">¬∂</a></h3>
<pre class="mermaid"><code>flowchart LR
  A[Create Tenant PR] --&gt; B[Terraform Cloud<br/>plan/apply<br/>project, VPC, MariaDB]
  B --&gt; C[DNS &amp; Cert bot]
  C --&gt; D[Argo CD<br/>sync tenant stack<br/>SMS + Sub services]
  D --&gt; E["API Gateway auto-route<br/>/sms/{tenant}"]
  E --&gt; F[Smoke Test suite]
</code></pre>
<ul>
<li><strong>Th·ªùi gian</strong>: \~ 25 ph√∫t/tenant (99-percentile).</li>
<li><strong>Output</strong>: Slack th√¥ng b√°o ‚ÄúTenant <em>abc</em> ready üéâ‚Äù.</li>
</ul>
<h3 id="86-quan-ly-cau-hinh-secrets">8.6 Qu·∫£n l√Ω C·∫•u h√¨nh &amp; Secrets<a class="headerlink" href="#86-quan-ly-cau-hinh-secrets" title="Permanent link">¬∂</a></h3>
<ul>
<li><strong>ADR-005</strong> ‚Äì c·∫•u h√¨nh qua <strong>ConfigMap/Secret</strong> ph√¢n t√°ch <code>env</code> v√† <code>tenant</code>.</li>
<li><strong>ADR-003</strong> ‚Äì Secrets (RSA key, OTP provider) l∆∞u <strong>GCP Secret Manager</strong> v·ªõi rotation cron.</li>
</ul>
<h3 id="87-kiem-soat-chi-phi-carbon">8.7 Ki·ªÉm so√°t Chi ph√≠ &amp; Carbon<a class="headerlink" href="#87-kiem-soat-chi-phi-carbon" title="Permanent link">¬∂</a></h3>
<ul>
<li><strong>FinOps Job</strong> ch·∫°y m·ªói ƒë√™m: truy v·∫•n Cloud Billing API ‚Üí BigQuery ‚Üí Grafana ‚ÄúCost/Tenant/Service‚Äù.</li>
<li>C·∫£nh b√°o Slack khi chi ph√≠ ch·ªách &gt; 20 % so v·ªõi trung b√¨nh 7 ng√†y.</li>
</ul>
<h3 id="88-so-o-luong-cicd-tong-quan">8.8 S∆° ƒë·ªì lu·ªìng CI/CD t·ªïng quan<a class="headerlink" href="#88-so-o-luong-cicd-tong-quan" title="Permanent link">¬∂</a></h3>
<pre class="mermaid"><code>graph TB
  Dev --&gt;|PR| GitHub
  GitHub --&gt;|CI pass| ArtifactRegistry
  ArtifactRegistry --&gt;|tag main| ArgoCD
  ArgoCD --&gt;|sync| Staging
  Staging --&gt;|integration ok| ArgoGate[Release Approval]
  ArgoGate --&gt;|canary| ProdCanary
  ProdCanary --&gt;|auto promote| Prod
  Prod --&gt;|metrics| Grafana
</code></pre>
<blockquote>
<p><strong>Ngu·ªìn tham chi·∫øu:</strong>
‚Ä¢ <code>ADR-001 ‚Äì CI/CD</code> ¬∑ <code>ADR-014 ‚Äì Zero-Downtime</code> ¬∑ <code>ADR-015 ‚Äì Deployment Strategy</code> ¬∑ <code>ADR-018 ‚Äì Release Approval Policy</code>
‚Ä¢ Terraform module <code>tenant-stack</code> ¬∑ Helm chart <code>dx-vas-core</code>.</p>
</blockquote>
<hr/>
<h2 id="9-data-reporting">9. Data &amp; Reporting<a class="headerlink" href="#9-data-reporting" title="Permanent link">¬∂</a></h2>
<blockquote>
<p>Ph·∫ßn n√†y tr√¨nh b√†y c√°ch <strong>DX-VAS</strong> thu th·∫≠p, l∆∞u tr·ªØ, qu·∫£n tr·ªã v√† khai th√°c d·ªØ li·ªáu ‚Äî t·ª´ <strong>SMS</strong> c·ªßa t·ª´ng tenant, qua <strong>ELT pipeline</strong>, v√†o <strong>Data Warehouse</strong>, v√† cu·ªëi c√πng hi·ªÉn th·ªã b√°o c√°o. C√°c quy·∫øt ƒë·ªãnh thi·∫øt k·∫ø d·ª±a tr√™n:<br/>
‚Ä¢ <code>ADR-023 Schema Migration</code> :contentReference[oaicite:0]{index=0} ¬∑ <code>ADR-024 Data Anonymization &amp; Retention</code> :contentReference[oaicite:1]{index=1} ¬∑ <code>ADR-026 Hard Delete Policy</code> :contentReference[oaicite:2]{index=2} ¬∑ <code>ADR-027 Data Management Strategy</code> :contentReference[oaicite:3]{index=3} ¬∑ <code>ADR-028 Reporting Architecture</code> :contentReference[oaicite:4]{index=4} ¬∑ <code>ADR-029 Report Template Schema</code> :contentReference[oaicite:5]{index=5} ¬∑ <code>ADR-030 Event Schema Governance</code> :contentReference[oaicite:6]{index=6}</p>
</blockquote>
<h3 id="91-nguon-du-lieu-goc-source-of-truth">9.1 Ngu·ªìn d·ªØ li·ªáu g·ªëc (Source-of-Truth)<a class="headerlink" href="#91-nguon-du-lieu-goc-source-of-truth" title="Permanent link">¬∂</a></h3>
<table>
<thead>
<tr>
<th>Ngu·ªìn</th>
<th>C√¥ng ngh·ªá</th>
<th>Ph√¢n v√πng</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>SMS DB (per tenant)</strong></td>
<td><strong>MariaDB</strong> Galera cluster</td>
<td>1 schema/tenant</td>
</tr>
<tr>
<td><strong>Event Bus</strong></td>
<td>Pub/Sub topic <code>tenant.*</code></td>
<td>Schema version =<code>v1</code></td>
</tr>
<tr>
<td><strong>Audit Log</strong></td>
<td>Cloud Logging ‚Üí BigQuery</td>
<td>B·∫£ng <code>audit_log_*</code> (partition date)</td>
</tr>
</tbody>
</table>
<h3 id="92-elt-pipeline-near-real-time">9.2 ELT Pipeline (near-real-time)<a class="headerlink" href="#92-elt-pipeline-near-real-time" title="Permanent link">¬∂</a></h3>
<pre class="mermaid"><code>flowchart LR
  SMS_MariaDB((MariaDB)) --&gt;|Debezium<br/>CDC| DataLake[(Cloud Storage<br/>Parquet Staging)]
  DataLake --&gt;|Dataflow<br/>transform| BQ[BigQuery<br/>Data Warehouse]
  PubSub((Pub/Sub)) --&gt;|Stream<br/>Dataflow| BQ
</code></pre>
<ul>
<li><strong>Extract</strong>: Debezium CDC dump <strong>insert/update/delete</strong> m·ªói tenant v√†o Cloud Storage (Parquet).</li>
<li><strong>Load</strong>: Scheduled Dataflow job n·∫°p incremental v√†o <strong>BigQuery</strong> staging.</li>
<li><strong>Transform</strong>: dbt ch·∫°y nightly t·∫°o <strong>Data Mart</strong> (<code>fct_enrolment</code>, <code>dim_student</code>, v.v.).</li>
<li><strong>Latency m·ª•c ti√™u</strong>: &lt; 5 ph√∫t cho s·ª± ki·ªán, &lt; 30 ph√∫t cho batch.</li>
</ul>
<h3 id="93-thiet-ke-data-warehouse">9.3 Thi·∫øt k·∫ø Data Warehouse<a class="headerlink" href="#93-thiet-ke-data-warehouse" title="Permanent link">¬∂</a></h3>
<table>
<thead>
<tr>
<th>Layer</th>
<th>Chi ti·∫øt</th>
<th>Partition / Cluster</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Raw</strong></td>
<td>1 b·∫£ng th√¥ / table_source / tenant</td>
<td><code>tenant_id</code>, <code>_PARTITIONDATE</code></td>
</tr>
<tr>
<td><strong>Staging</strong></td>
<td>Chu·∫©n ho√° ki·ªÉu d·ªØ li·ªáu, th√™m <code>load_ts</code></td>
<td>nh∆∞ Raw</td>
</tr>
<tr>
<td><strong>Mart</strong></td>
<td>Fact / Dim theo Kimball (star schema)</td>
<td>cluster <code>tenant_id</code> &amp; business_key</td>
</tr>
<tr>
<td><strong>Sandbox</strong></td>
<td>Export dataset cho ML / BI</td>
<td>ACL theo RBAC (teacher, admin)</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>Retention</strong>: Raw = 30 ng√†y (xem <code>ADR-024</code>); Mart gi·ªØ 5 nƒÉm, b·∫£n ghi PII ƒë∆∞·ª£c ·∫©n danh (hash + salt).</p>
</blockquote>
<h3 id="94-bao-cao-bi">9.4 B√°o c√°o &amp; BI<a class="headerlink" href="#94-bao-cao-bi" title="Permanent link">¬∂</a></h3>
<ul>
<li><strong>Reporting Service</strong> ƒë·ªçc Mart, sinh <strong>dashboard multi-tenant</strong> (Grafana, Superset).</li>
<li>M·ªói b√°o c√°o tu√¢n th·ªß <strong>template JSON Schema</strong> v1.0 (ƒë·ªãnh nghƒ©a t·∫°i <code>ADR-029</code>).</li>
<li><strong>Public API</strong> <code>/reports/:id/export</code> tr·∫£ v·ªÅ CSV / Parquet; Gateway g·∫Øn header <code>X-Tenant-ID</code>.</li>
</ul>
<h3 id="95-data-governance-compliance">9.5 Data Governance &amp; Compliance<a class="headerlink" href="#95-data-governance-compliance" title="Permanent link">¬∂</a></h3>
<table>
<thead>
<tr>
<th>Ch√≠nh s√°ch</th>
<th>N·ªôi dung then ch·ªët</th>
<th>ADR</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Schema Versioning</strong></td>
<td>M·ªçi event/b·∫£ng c√≥ <code>schema_version</code> theo <code>adr-030</code>; backward-compatible ‚â• 6 th√°ng.</td>
<td>030</td>
</tr>
<tr>
<td><strong>Migration</strong></td>
<td>Flyway <code>V__</code> script, PR review b·∫Øt bu·ªôc (<code>adr-023</code>).</td>
<td>023</td>
</tr>
<tr>
<td><strong>Anonymization</strong></td>
<td>Hash + salt cho PII; d·∫°y d·ªØ li·ªáu demo qua <code>synthetic_*</code> view.</td>
<td>024</td>
</tr>
<tr>
<td><strong>Hard Delete</strong></td>
<td>TTL API <code>/delete</code> ‚Üí soft flag, job purge sau 30 ng√†y.</td>
<td>026</td>
</tr>
<tr>
<td><strong>Data Lifecycle</strong></td>
<td>Tier S3‚ÜíNearline‚ÜíColdline ‚â• 3 nƒÉm; policy BQ partition expire.</td>
<td>027</td>
</tr>
</tbody>
</table>
<h3 id="96-quan-sat-sla-du-lieu">9.6 Quan s√°t &amp; SLA d·ªØ li·ªáu<a class="headerlink" href="#96-quan-sat-sla-du-lieu" title="Permanent link">¬∂</a></h3>
<table>
<thead>
<tr>
<th>Metric</th>
<th>M·ª•c ti√™u</th>
<th>Alert</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>ELT lag (p95)</strong></td>
<td>&lt; 10 ph√∫t</td>
<td>&gt; 20 ph√∫t 15‚Ä≤</td>
</tr>
<tr>
<td><strong>Data Quality test pass</strong></td>
<td>= 100 %</td>
<td>b·∫•t k·ª≥ l·ªói Great Expectations</td>
</tr>
<tr>
<td><strong>Warehouse cost/tenant</strong></td>
<td>+‚â§ 15 % so v·ªõi 30 ng√†y</td>
<td>Slack FinOps daily</td>
</tr>
</tbody>
</table>
<h3 id="97-tich-hop-event-schema-governance">9.7 T√≠ch h·ª£p Event Schema Governance<a class="headerlink" href="#97-tich-hop-event-schema-governance" title="Permanent link">¬∂</a></h3>
<ul>
<li>M·ªçi s·ª± ki·ªán <code>*.*.v1</code> ph·∫£i ƒëƒÉng k√Ω schema Avro trong <strong>Schema Registry</strong> (<code>ADR-030</code>).</li>
<li>Pipeline Dataflow validate schema ID tr∆∞·ªõc khi n·∫°p v√†o BigQuery; sai l·ªách ‚Üí g·ª≠i <code>error.code=data.schema_mismatch</code>.</li>
</ul>
<blockquote>
<p>N·ªÅn t·∫£ng d·ªØ li·ªáu DX-VAS ƒë∆∞·ª£c d·ª±ng ƒë·ªÉ <strong>d·ªÖ m·ªü r·ªông</strong>, <strong>tu√¢n th·ªß</strong> (GDPR) v√† <strong>t·ªëi ∆∞u chi ph√≠</strong> ‚Äî b·∫£o ƒë·∫£m m·ªói tenant truy c·∫≠p b√°o c√°o k·ªãp th·ªùi m√† kh√¥ng ·∫£nh h∆∞·ªüng d·ªØ li·ªáu tenant kh√°c.</p>
</blockquote>
<hr/>
<h2 id="10-adr-cr-index">10. ADR &amp; CR Index<a class="headerlink" href="#10-adr-cr-index" title="Permanent link">¬∂</a></h2>
<h3 id="101-architecture-decision-records-adr">10.1 Architecture Decision Records (ADR)<a class="headerlink" href="#101-architecture-decision-records-adr" title="Permanent link">¬∂</a></h3>
<table>
<thead>
<tr>
<th>ID</th>
<th>T√™n / Ch·ªß ƒë·ªÅ</th>
<th>ƒê∆∞·ªùng d·∫´n</th>
</tr>
</thead>
<tbody>
<tr>
<td>001</td>
<td>CI/CD &amp; GitOps Pipeline</td>
<td><a href="ADR/adr-001-ci-cd/">adr-001-ci-cd.md</a></td>
</tr>
<tr>
<td>002</td>
<td>Infrastructure-as-Code (Terraform)</td>
<td><a href="ADR/adr-002-iac/">adr-002-iac.md</a></td>
</tr>
<tr>
<td>003</td>
<td>Secrets Management &amp; Key Rotation</td>
<td><a href="ADR/adr-003-secrets/">adr-003-secrets.md</a></td>
</tr>
<tr>
<td>004</td>
<td>Security Principles &amp; Trust Boundary</td>
<td><a href="ADR/adr-004-security/">adr-004-security.md</a></td>
</tr>
<tr>
<td>005</td>
<td>Environment Configuration Strategy</td>
<td><a href="ADR/adr-005-env-config/">adr-005-env-config.md</a></td>
</tr>
<tr>
<td>006</td>
<td>Auth Strategy &amp; Token Service</td>
<td><a href="ADR/adr-006-auth-strategy/">adr-006-auth-strategy.md</a></td>
</tr>
<tr>
<td>007</td>
<td>Role-Based Access Control (RBAC)</td>
<td><a href="ADR/adr-007-rbac/">adr-007-rbac.md</a></td>
</tr>
<tr>
<td>008</td>
<td>Audit Logging</td>
<td><a href="ADR/adr-008-audit-logging/">adr-008-audit-logging.md</a></td>
</tr>
<tr>
<td>009</td>
<td>API Governance &amp; Style</td>
<td><a href="ADR/adr-009-api-governance/">adr-009-api-governance.md</a></td>
</tr>
<tr>
<td>010</td>
<td>Contract Testing</td>
<td><a href="ADR/adr-010-contract-testing/">adr-010-contract-testing.md</a></td>
</tr>
<tr>
<td>011</td>
<td>API Error Format (ErrorEnvelope)</td>
<td><a href="ADR/adr-011-api-error-format/">adr-011-api-error-format.md</a></td>
</tr>
<tr>
<td>012</td>
<td>Standard Response Structure</td>
<td><a href="ADR/adr-012-response-structure/">adr-012-response-structure.md</a></td>
</tr>
<tr>
<td>013</td>
<td>Path Naming Convention</td>
<td><a href="ADR/adr-013-path-naming-convention/">adr-013-path-naming-convention.md</a></td>
</tr>
<tr>
<td>014</td>
<td>Zero-Downtime Deployment</td>
<td><a href="ADR/adr-014-zero-downtime/">adr-014-zero-downtime.md</a></td>
</tr>
<tr>
<td>015</td>
<td>Deployment Strategy &amp; Boundary</td>
<td><a href="ADR/adr-015-deployment-strategy/">adr-015-deployment-strategy.md</a></td>
</tr>
<tr>
<td>016</td>
<td>Auto-Scaling Policy</td>
<td><a href="ADR/adr-016-auto-scaling/">adr-016-auto-scaling.md</a></td>
</tr>
<tr>
<td>017</td>
<td>Environment Deploy Boundary</td>
<td><a href="ADR/adr-017-env-deploy-boundary/">adr-017-env-deploy-boundary.md</a></td>
</tr>
<tr>
<td>018</td>
<td>Release Approval Policy</td>
<td><a href="ADR/adr-018-release-approval-policy/">adr-018-release-approval-policy.md</a></td>
</tr>
<tr>
<td>019</td>
<td>Project Layout Standard</td>
<td><a href="ADR/adr-019-project-layout/">adr-019-project-layout.md</a></td>
</tr>
<tr>
<td>020</td>
<td>Cost Observability</td>
<td><a href="ADR/adr-020-cost-observability/">adr-020-cost-observability.md</a></td>
</tr>
<tr>
<td>021</td>
<td>External Observability &amp; SLA</td>
<td><a href="ADR/adr-021-external-observability/">adr-021-external-observability.md</a></td>
</tr>
<tr>
<td>022</td>
<td>SLA / SLO Monitoring</td>
<td><a href="ADR/adr-022-sla-slo-monitoring/">adr-022-sla-slo-monitoring.md</a></td>
</tr>
<tr>
<td>023</td>
<td>Schema Migration Strategy</td>
<td><a href="ADR/adr-023-schema-migration-strategy/">adr-023-schema-migration-strategy.md</a></td>
</tr>
<tr>
<td>024</td>
<td>Data Anonymization &amp; Retention</td>
<td><a href="ADR/adr-024-data-anonymization-retention/">adr-024-data-anonymization-retention.md</a></td>
</tr>
<tr>
<td>025</td>
<td>Multi-Tenant Versioning</td>
<td><a href="ADR/adr-025-multi-tenant-versioning/">adr-025-multi-tenant-versioning.md</a></td>
</tr>
<tr>
<td>026</td>
<td>Hard-Delete Policy</td>
<td><a href="ADR/adr-026-hard-delete-policy/">adr-026-hard-delete-policy.md</a></td>
</tr>
<tr>
<td>027</td>
<td>Data Management Strategy</td>
<td><a href="ADR/adr-027-data-management-strategy/">adr-027-data-management-strategy.md</a></td>
</tr>
<tr>
<td>028</td>
<td>Reporting Architecture</td>
<td><a href="ADR/adr-028-reporting-architecture/">adr-028-reporting-architecture.md</a></td>
</tr>
<tr>
<td>029</td>
<td>Report Template Schema</td>
<td><a href="ADR/adr-029-report-template-schema/">adr-029-report-template-schema.md</a></td>
</tr>
<tr>
<td>030</td>
<td>Event Schema Governance</td>
<td><a href="ADR/adr-030-event-schema-governance/">adr-030-event-schema-governance.md</a></td>
</tr>
</tbody>
</table>
<hr/>
<h3 id="102-change-requests-cr">10.2 Change Requests (CR)<a class="headerlink" href="#102-change-requests-cr" title="Permanent link">¬∂</a></h3>
<table>
<thead>
<tr>
<th>M√£ CR</th>
<th>M√¥ t·∫£ ng·∫Øn</th>
<th>ƒê∆∞·ªùng d·∫´n</th>
</tr>
</thead>
<tbody>
<tr>
<td>03-CR</td>
<td>Gi·ªõi thi·ªáu <strong>Token Service</strong>, chu·∫©n h√≥a JWT lifecycle</td>
<td><a href="./requests/03-cr-token-service.md">03-cr-token-service.md</a></td>
</tr>
<tr>
<td>04-CR</td>
<td><strong>Tenant Stack</strong> simplification &amp; School Management System</td>
<td><a href="./requests/04-cr-tenant-system.md">04-cr-tenant-system.md</a></td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>Ghi ch√∫:</strong><br/>
<em> </em><em>ADR</em><em> = quy·∫øt ƒë·ªãnh ki·∫øn tr√∫c l√¢u d√†i; </em><em>CR</em><em> = thay ƒë·ªïi l·ªõn ƒë∆∞·ª£c ph√™ duy·ªát sau giai ƒëo·∫°n thi·∫øt k·∫ø chi ti·∫øt.<br/>
</em> M·ªçi PR m·ªõi thay ƒë·ªïi ki·∫øn tr√∫c <strong>ph·∫£i</strong> k√®m ADR / CR t∆∞∆°ng ·ª©ng tr∆∞·ªõc khi merge v√†o <code>main</code>.</p>
</blockquote>
<hr/>
<h2 id="11-standards-conventions">11. Standards &amp; Conventions<a class="headerlink" href="#11-standards-conventions" title="Permanent link">¬∂</a></h2>
<blockquote>
<p><strong>M·ª•c ƒë√≠ch</strong> ‚Äì B·∫£o ƒë·∫£m <strong>m·ªçi th√†nh ph·∫ßn</strong> c·ªßa DX-VAS tu√¢n th·ªß m·ªôt b·ªô quy ∆∞·ªõc th·ªëng nh·∫•t v·ªÅ thi·∫øt k·∫ø d·ªãch v·ª•, d·ªØ li·ªáu, API, m√£ l·ªói, versioning v√† style code, gi√∫p <strong>gi·∫£m sai s√≥t</strong>, <strong>d·ªÖ b·∫£o tr√¨</strong> v√† <strong>ƒë·ªìng nh·∫•t tr·∫£i nghi·ªám</strong>.</p>
</blockquote>
<h3 id="111-bo-tieu-chuan-5-5-star-standards">11.1 B·ªô ti√™u chu·∫©n ‚Äú5‚òÖ‚Äù (5-Star Standards)<a class="headerlink" href="#111-bo-tieu-chuan-5-5-star-standards" title="Permanent link">¬∂</a></h3>
<table>
<thead>
<tr>
<th>‚≠ê</th>
<th>T√†i li·ªáu</th>
<th>Ph·∫°m vi</th>
<th>B·∫Øt bu·ªôc</th>
</tr>
</thead>
<tbody>
<tr>
<td>‚≠ê1</td>
<td><a href="standards/5s.service.design.standard/">5s.service.design.standard.md</a></td>
<td>Chi·∫øn l∆∞·ª£c service, boundary, SLA, deploy</td>
<td>‚úî</td>
</tr>
<tr>
<td>‚≠ê2</td>
<td><a href="standards/5s.data.model.standard/">5s.data.model.standard.md</a></td>
<td>Quy t·∫Øc ƒë·∫∑t t√™n b·∫£ng/field, kho√° ngo·∫°i, index</td>
<td>‚úî</td>
</tr>
<tr>
<td>‚≠ê3</td>
<td><a href="standards/5s.interface.contract.doc.standard/">5s.interface.contract.doc.standard.md</a></td>
<td>C√°ch vi·∫øt t√†i li·ªáu Interface Contract (IC)</td>
<td>‚úî</td>
</tr>
<tr>
<td>‚≠ê4</td>
<td><a href="standards/5s.openapi.standard/">5s.openapi.standard.md</a></td>
<td>Quy ƒë·ªãnh OpenAPI (tags, schemas, examples)</td>
<td>‚úî</td>
</tr>
<tr>
<td>‚≠ê5</td>
<td><strong>Security Appendix</strong> (trong ‚≠ê1)</td>
<td>OWASP, mTLS, key rotation</td>
<td>‚úî</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>Check-list CI</strong>: PR n√†o ch·ª©a file IC/OpenAPI s·∫Ω ch·∫°y <strong>linter 5‚òÖ</strong> ‚Äì fail n·∫øu vi ph·∫°m.</p>
</blockquote>
<h3 id="112-error-codes-envelope">11.2 Error Codes &amp; Envelope<a class="headerlink" href="#112-error-codes-envelope" title="Permanent link">¬∂</a></h3>
<table>
<thead>
<tr>
<th>Quy chu·∫©n</th>
<th>ƒê∆∞·ªùng d·∫´n</th>
<th>Ghi ch√∫</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>ErrorEnvelope</strong></td>
<td>ADR-011</td>
<td>Field <code>error</code>, <code>meta</code> b·∫Øt bu·ªôc</td>
</tr>
<tr>
<td><strong>Danh m·ª•c m√£ l·ªói</strong></td>
<td><a href="standards/error-codes/">error-codes.md</a></td>
<td>ƒê·∫∑t t√™n <code>namespace.snake_case</code> (vd: <code>token.expired</code>)</td>
</tr>
<tr>
<td><strong>Th√™m m√£ l·ªói m·ªõi</strong></td>
<td>Update PR v√†o file tr√™n + reviewer ‚ÄúTech Lead API‚Äù</td>
<td>Kh√¥ng tr√πng namespace</td>
</tr>
</tbody>
</table>
<h3 id="113-naming-versioning">11.3 Naming &amp; Versioning<a class="headerlink" href="#113-naming-versioning" title="Permanent link">¬∂</a></h3>
<table>
<thead>
<tr>
<th>Th·ª±c th·ªÉ</th>
<th>Quy t·∫Øc ch√≠nh</th>
<th>ADR / Standard</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>API Path</strong></td>
<td><code>/resource/{id}</code>, verb = HTTP; <strong>kh√¥ng</strong> ‚Äú/getFoo‚Äù</td>
<td>ADR-013</td>
</tr>
<tr>
<td><strong>Event</strong></td>
<td><code>domain.action.v{major}</code> ‚Äì vd: <code>token.issued.v1</code></td>
<td>ADR-030</td>
</tr>
<tr>
<td><strong>Docker Image</strong></td>
<td><code>service:MAJOR.MINOR.PATCH</code> (SemVer)</td>
<td>ADR-015</td>
</tr>
<tr>
<td><strong>Tenant Stack</strong></td>
<td><code>dx-vas-tenant-&lt;slug&gt;</code> (lower-kebab)</td>
<td>ADR-019</td>
</tr>
<tr>
<td><strong>Branch Git</strong></td>
<td><code>feature/&lt;ticket&gt;</code>, <code>fix/&lt;ticket&gt;</code></td>
<td>ADR-001</td>
</tr>
<tr>
<td><strong>DB Migration</strong></td>
<td><code>V&lt;yyyyMMddHHmm&gt;__&lt;desc&gt;.sql</code> (Flyway)</td>
<td>ADR-023</td>
</tr>
</tbody>
</table>
<h3 id="114-style-guide-code-docs">11.4 Style Guide (Code &amp; Docs)<a class="headerlink" href="#114-style-guide-code-docs" title="Permanent link">¬∂</a></h3>
<table>
<thead>
<tr>
<th>Ng√¥n ng·ªØ</th>
<th>Linter / Formatter</th>
<th>Rule n·ªïi b·∫≠t</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Python</strong></td>
<td>ruff + black</td>
<td>max-line 120, type-hint b·∫Øt bu·ªôc</td>
</tr>
<tr>
<td><strong>TypeScript</strong></td>
<td>eslint + prettier</td>
<td>strictNullChecks, import alias <code>@/</code></td>
</tr>
<tr>
<td><strong>Terraform</strong></td>
<td><code>terraform fmt</code> + tflint</td>
<td>module version lock</td>
</tr>
<tr>
<td><strong>SQL (MariaDB)</strong></td>
<td>sqlfluff (<code>ansi</code>)</td>
<td>snake_case table/column</td>
</tr>
<tr>
<td><strong>Markdown</strong></td>
<td>markdownlint</td>
<td>ATX heading, table alignment</td>
</tr>
<tr>
<td><strong>Mermaid</strong></td>
<td>kroki validate</td>
<td>ph·∫£i k√®m ch√∫ th√≠ch key ƒë∆∞·ªùng n·ªëi</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>Docs-as-Code</strong>: M·ªçi t√†i li·ªáu (ADR, SDD, IC) l∆∞u trong Git, PR review = code.</p>
</blockquote>
<h3 id="115-kiem-tra-tuan-thu-ci-checks">11.5 Ki·ªÉm tra tu√¢n th·ªß (CI Checks)<a class="headerlink" href="#115-kiem-tra-tuan-thu-ci-checks" title="Permanent link">¬∂</a></h3>
<ol>
<li><strong>5‚òÖ Linter</strong> ‚Äì validate OpenAPI &amp; IC.  </li>
<li><strong>Schema Registry</strong> ‚Äì event Avro ID ph·∫£i kh·ªõp ADR-030.  </li>
<li><strong>SBOM &amp; CVE Scan</strong> ‚Äì block CVE High/critical.  </li>
<li><strong>Error code validator</strong> ‚Äì compare <code>error.code</code> xu·∫•t hi·ªán trong OpenAPI v·ªõi danh s√°ch chu·∫©n.  </li>
</ol>
<h3 id="116-ngoai-le-quy-trinh-phe-duyet">11.6 Ngo·∫°i l·ªá &amp; Quy tr√¨nh ph√™ duy·ªát<a class="headerlink" href="#116-ngoai-le-quy-trinh-phe-duyet" title="Permanent link">¬∂</a></h3>
<ul>
<li>Ngo·∫°i l·ªá <strong>hi·∫øm</strong> (P0 deadline, legacy) ‚áí t·∫°o <strong>RFC</strong> k√®m justification, g·∫Øn label <code>standards-waiver</code>, review b·ªüi <strong>Architecture Board</strong>.  </li>
<li>Sau 60 ng√†y, <strong>waiver</strong> h·∫øt h·∫°n; service ph·∫£i retrofit v·ªÅ ƒë√∫ng chu·∫©n.</li>
</ul>
<blockquote>
<p><strong>Nh·∫Øc l·∫°i</strong> ‚Äì ‚ÄúConsistency is speed.‚Äù Tu√¢n th·ªß b·ªô chu·∫©n tr√™n gi√∫p ƒë·ªôi ng≈© DX-VAS <strong>ship nhanh h∆°n</strong> m√† kh√¥ng ƒë√°nh ƒë·ªïi ch·∫•t l∆∞·ª£ng ho·∫∑c an to√†n.</p>
</blockquote>
<hr/>
<h2 id="12-appendix">12. Appendix<a class="headerlink" href="#12-appendix" title="Permanent link">¬∂</a></h2>
<h3 id="121-thuat-ngu-glossary">12.1 Thu·∫≠t ng·ªØ (Glossary)<a class="headerlink" href="#121-thuat-ngu-glossary" title="Permanent link">¬∂</a></h3>
<table>
<thead>
<tr>
<th>Thu·∫≠t ng·ªØ</th>
<th>ƒê·ªãnh nghƒ©a ng·∫Øn</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Tenant</strong></td>
<td>M·ªôt c∆° s·ªü/tr∆∞·ªùng s·ª≠ d·ª•ng DX-VAS; t√°ch bi·ªát b·∫±ng <code>tenant_id</code>.</td>
</tr>
<tr>
<td><strong>Tenant Stack</strong></td>
<td>Nh√≥m d·ªãch v·ª• c·ª•c b·ªô c·ªßa tenant: SMS + Auth/User/Notif Sub + DB/Cache.</td>
</tr>
<tr>
<td><strong>SMS (School Management System)</strong></td>
<td>Backend t√≠ch h·ª£p CRM + SIS + LMS cho t·ª´ng tenant.</td>
</tr>
<tr>
<td><strong>JWT (JSON Web Token)</strong></td>
<td>Chu·ªói k√Ω RS256 mang claim <code>sub</code>, <code>tid</code>, <code>roles</code>, v.v.</td>
</tr>
<tr>
<td><strong>JWKS</strong></td>
<td>T·∫≠p public key (JSON) ƒë·ªÉ Gateway x√°c th·ª±c ch·ªØ k√Ω JWT.</td>
</tr>
<tr>
<td><strong>Token Service</strong></td>
<td>Micro-service ph√°t h√†nh, l√†m m·ªõi, thu h·ªìi JWT.</td>
</tr>
<tr>
<td><strong>RBAC</strong></td>
<td>Role-Based Access Control ‚Äì u·ª∑ quy·ªÅn d·ª±a tr√™n <code>roles</code> / <code>permissions</code>.</td>
</tr>
<tr>
<td><strong>ADR</strong></td>
<td>Architecture Decision Record ‚Äì quy·∫øt ƒë·ªãnh ki·∫øn tr√∫c d√†i h·∫°n.</td>
</tr>
<tr>
<td><strong>CR</strong></td>
<td>Change Request ‚Äì thay ƒë·ªïi l·ªõn sau giai ƒëo·∫°n ph√¢n t√≠ch.</td>
</tr>
<tr>
<td><strong>ELT</strong></td>
<td>Extract-Load-Transform pipeline tr√≠ch xu·∫•t d·ªØ li·ªáu v√†o DW.</td>
</tr>
<tr>
<td><strong>DW (Data Warehouse)</strong></td>
<td>BigQuery ch·ª©a d·ªØ li·ªáu ph√¢n t√≠ch nhi·ªÅu tenant.</td>
</tr>
<tr>
<td><strong>Pub/Sub</strong></td>
<td>H√†ng ƒë·ª£i s·ª± ki·ªán b·∫•t ƒë·ªìng b·ªô c·ªßa Google Cloud.</td>
</tr>
<tr>
<td><strong>SLO / SLA</strong></td>
<td>Service Level Objective / Agreement ‚Äì cam k·∫øt ch·∫•t l∆∞·ª£ng d·ªãch v·ª•.</td>
</tr>
<tr>
<td><strong>ErrorEnvelope</strong></td>
<td>C·∫•u tr√∫c JSON chu·∫©n ƒë·ªÉ tr·∫£ l·ªói (<code>error</code>, <code>meta</code>).</td>
</tr>
</tbody>
</table>
<h3 id="122-danh-ba-contacts">12.2 Danh b·∫° (Contacts)<a class="headerlink" href="#122-danh-ba-contacts" title="Permanent link">¬∂</a></h3>
<table>
<thead>
<tr>
<th>Vai tr√≤</th>
<th>T√™n / Nh√≥m</th>
<th>Li√™n h·ªá</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Chief Architect</strong></td>
<td>John Ng.</td>
<td><code>john.ng@dx-vas.io</code></td>
</tr>
<tr>
<td><strong>SRE Lead</strong></td>
<td>Linh P.</td>
<td><code>sre@dx-vas.io</code></td>
</tr>
<tr>
<td><strong>Product Owner</strong></td>
<td>Ms. Thu H.</td>
<td><code>po@dx-vas.io</code></td>
</tr>
<tr>
<td><strong>Architecture Board</strong></td>
<td><code>#arch-board</code> Slack channel</td>
<td>H·ªçp th·ª© 5 h√†ng tu·∫ßn</td>
</tr>
<tr>
<td><strong>Incident Hotline</strong></td>
<td>PagerDuty (P1)</td>
<td><code>+84 28 7100 xxxx</code></td>
</tr>
</tbody>
</table>
<p><em>(ƒê·ªãa ch·ªâ email/ƒëi·ªán tho·∫°i ch·ªâ l√† v√≠ d·ª•; c·∫≠p nh·∫≠t khi √°p d·ª•ng th·ª±c t·∫ø.)</em></p>
<h3 id="123-changelog-tom-tat">12.3 Changelog (T√≥m t·∫Øt)<a class="headerlink" href="#123-changelog-tom-tat" title="Permanent link">¬∂</a></h3>
<table>
<thead>
<tr>
<th>Phi√™n b·∫£n</th>
<th>Ng√†y</th>
<th>Thay ƒë·ªïi ch√≠nh</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>v2-draft</strong></td>
<td>2025-06-09</td>
<td><em>T·∫°o skeleton README.v2.md</em> ‚Äì c·∫•u tr√∫c 12 m·ª•c.</td>
</tr>
<tr>
<td><strong>v2-beta</strong></td>
<td>2025-06-10</td>
<td>T√≠ch h·ª£p <strong>Token Service CR-03</strong> &amp; <strong>Tenant Stack CR-04</strong>.<br/>Vi·∫øt l·∫°i Vision, Architecture, Auth Flow, Token, SMS.</td>
</tr>
<tr>
<td><strong>v2-rc1</strong></td>
<td>2025-06-11</td>
<td>Ho√†n t·∫•t Observability, CI/CD, Data, Standards, Glossary.</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>L∆∞u √Ω:</strong> Changelog ch·ªâ ghi <strong>thay ƒë·ªïi ·ªü c·∫•p ki·∫øn tr√∫c/t√†i li·ªáu</strong>. Thay ƒë·ªïi code chi ti·∫øt xem Git commit history.</p>
</blockquote>
<h3 id="124-tai-lieu-bo-sung">12.4 T√†i li·ªáu b·ªï sung<a class="headerlink" href="#124-tai-lieu-bo-sung" title="Permanent link">¬∂</a></h3>
<table>
<thead>
<tr>
<th>Ch·ªß ƒë·ªÅ</th>
<th>Li√™n k·∫øt</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Diagrams (SVG/PNG)</strong></td>
<td><code>docs/diagrams/</code></td>
</tr>
<tr>
<td><strong>Service Design Docs (SDD)</strong></td>
<td><code>docs/services/index.md</code></td>
</tr>
<tr>
<td><strong>API Reference (OpenAPI)</strong></td>
<td><code>docs/openapi/</code> <em>(auto-generated)</em></td>
</tr>
<tr>
<td><strong>Runbooks &amp; Playbooks</strong></td>
<td><code>ops/runbook/</code></td>
</tr>
<tr>
<td><strong>Governance RFCs</strong></td>
<td><code>docs/rfc/</code></td>
</tr>
</tbody>
</table>
<hr/>
<blockquote>
<p><em>DX-VAS Platform Documentation v2.</em><br>
Ph√°t h√†nh theo gi·∫•y ph√©p n·ªôi b·ªô; kh√¥ng sao ch√©p khi ch∆∞a c√≥ s·ª± ƒë·ªìng √Ω b·∫±ng vƒÉn b·∫£n.</br></p>
</blockquote>
<hr/>
</article>
</div>
<script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
<button class="md-top md-icon" data-md-component="top" hidden="" type="button">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg>
  Tr·ªü l·∫°i m·ª•c l·ª•c
</button>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": ".", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.top", "navigation.indexes", "search.suggest", "search.highlight", "content.code.annotate", "content.tabs.link"], "search": "assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "\u0110\u00e3 sao ch\u00e9p", "clipboard.copy": "Sao ch\u00e9p v\u00e0o b\u1ed9 nh\u1edb t\u1ea1m", "search.result.more.one": "1 t\u1eeb kh\u00e1c trong trang", "search.result.more.other": "# t\u1eeb kh\u00e1c trong trang", "search.result.none": "Kh\u00f4ng t\u00ecm th\u1ea5y t\u00e0i li\u1ec7u li\u00ean quan", "search.result.one": "1 t\u00e0i li\u1ec7u li\u00ean quan", "search.result.other": "# t\u00e0i li\u1ec7u li\u00ean quan", "search.result.placeholder": "Nh\u1eadp \u0111\u1ec3 b\u1eaft \u0111\u1ea7u t\u00ecm ki\u1ebfm", "search.result.term.missing": "Kh\u00f4ng", "select.version": "Ch\u1ecdn phi\u00ean b\u1ea3n"}, "version": null}</script>
<script src="assets/javascripts/bundle.13a4f30d.min.js"></script>
<script type="module">import mermaid from "https://unpkg.com/mermaid@10.4.0/dist/mermaid.esm.min.mjs";
window.mermaidConfig = {default: {
    startOnLoad: false
}};</script></body>
</html>